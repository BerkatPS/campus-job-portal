import{q as je,r as d,j as e,a as ge,b as i,m as y,J as X,A as ye,f as Z}from"./app-DbtvrzCH.js";import{T as ue}from"./Table-B5QHKXcj.js";import{B as A,I as u}from"./Button-CgCKgwRd.js";import{M as ve}from"./Modal-B-OjsfG3.js";import{A as we}from"./Alert-BWXyQfZl.js";import{S as Se}from"./Select-GW1WnAoX.js";import{L as Ce}from"./Layout-nP23ILEi.js";import{B as o,T as a,P as v}from"./Button-B_2tu0cn.js";import{A as b,C as D}from"./Slide-DsAvN5qg.js";import{P as U}from"./Person-C1OGobf6.js";import{A as Ie}from"./Add-DoOXNSNv.js";import{C as ee}from"./CheckCircleOutline-D6CUxKxL.js";import{D as te}from"./DoDisturbOn-RAd5iuyo.js";import{T as w,S as Te}from"./Work-bK6ZZ-Qp.js";import{C as Re}from"./CloudDownload-DPHjtUjP.js";import{P as Ae}from"./Print-K67R6tf8.js";import{R as De}from"./Sidebar-sw6YawgY.js";import{T as We,a as L}from"./Tabs-DDppPwJC.js";import{T as $e}from"./TextField-BKjSZQPY.js";import{I as ke}from"./InputAdornment-Vh23wNde.js";import{F as ie}from"./FilterList-D0xY2zDR.js";import{D as M}from"./Delete-DKhiqqSP.js";import{V as ze}from"./Visibility-7zZFC74a.js";import"./TableRow-DitY7KzI.js";import"./Checkbox-D9hSuJOi.js";import"./SwitchBase-BHRWgqGq.js";import"./TablePagination-DtYWInOg.js";import"./KeyboardArrowRight-B784So0V.js";import"./LastPage-ByPDXHdv.js";import"./Select-DuuFGO1T.js";import"./DialogContent-CpDcnQgJ.js";import"./DialogTitle-CnVKeRzh.js";import"./Close-BbHhCS19.js";import"./DialogContentText-BbIC-bWf.js";import"./Alert-D22fyny9.js";import"./Close-Dpj-0MLQ.js";import"./AlertTitle-CTfZdqfc.js";import"./AccessTime-as3EkDL5.js";import"./ArrowForward-jR7HuMfl.js";import"./Error-D1IMUwky.js";import"./Warning-CYk4HSbS.js";import"./Info-j9m1PK-Q.js";import"./CheckCircle-nvk-SVVX.js";import"./LinearProgress-Cp3Ye6up.js";import"./InputLabel-DUQX8vmT.js";import"./Footer-BBk2Lp_N.js";import"./Container-CHMV_DAY.js";import"./index-BJHsQb-H.js";import"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import"./ChevronRight-Bjx9uoMx.js";import"./People-KxvvNdCJ.js";import"./Event-JhFTkm8A.js";const zt=()=>{var O,H,J,V,q,Y,G,K;const{users:s,filters:c,roles:oe,flash:j}=je().props,[p,B]=d.useState((c==null?void 0:c.search)||""),[W,P]=d.useState(!1),[ae,I]=d.useState(!1),[x,_]=d.useState(null),[re,$]=d.useState(""),[se,k]=d.useState("success"),[ne,S]=d.useState(!1),[z,N]=d.useState(0),[g,E]=d.useState((c==null?void 0:c.role)||""),[T,R]=d.useState((c==null?void 0:c.status)||"");d.useEffect(()=>{if(j!=null&&j.message){$(j.message),k(j.type||"success"),S(!0);const t=setTimeout(()=>{S(!1)},5e3);return()=>clearTimeout(t)}},[j]);const le=(t,r)=>{N(r),r===0?R(""):r===1?R("active"):r===2&&R("inactive")},de=()=>{x&&(P(!0),Z.delete(route("admin.users.destroy",x.id),{onSuccess:()=>{I(!1),_(null),$("User deleted successfully."),k("success"),S(!0)},onError:t=>{$("Failed to delete user: "+Object.values(t).flat().join(" ")),k("error"),S(!0)},onFinish:()=>P(!1)}))},ce=[{field:"avatar",header:"",width:"60px",render:(t,r)=>{var n;return e.jsx(o,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(b,{src:t,alt:r.name,sx:{width:40,height:40,boxShadow:`0 2px 8px ${i("#000",.1)}`},children:(n=r.name)==null?void 0:n.charAt(0).toUpperCase()})})}},{field:"name",header:"Name",sortable:!0,render:(t,r)=>e.jsxs(o,{children:[e.jsx(a,{variant:"body1",fontWeight:500,children:t}),e.jsx(a,{variant:"caption",color:"text.secondary",children:r.email}),r.nim&&e.jsxs(a,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:["NIM: ",r.nim]})]})},{field:"role",header:"Role",sortable:!0,render:t=>e.jsx(D,{label:(t==null?void 0:t.name)||"No Role",color:"primary",size:"small",variant:"outlined",sx:{fontWeight:500}})},{field:"is_active",header:"Status",sortable:!0,render:t=>e.jsx(o,{sx:{display:"flex",alignItems:"center",gap:.5},children:t?e.jsx(D,{icon:e.jsx(ee,{fontSize:"small"}),label:"Active",color:"success",size:"small",variant:"filled",sx:{bgcolor:i("#4caf50",.1),color:"#2e7d32",fontWeight:500,"& .MuiChip-icon":{fontSize:"1rem",color:"inherit"}}}):e.jsx(D,{icon:e.jsx(te,{fontSize:"small"}),label:"Inactive",color:"default",size:"small",variant:"outlined",sx:{color:i("#000",.6),fontWeight:500,"& .MuiChip-icon":{fontSize:"1rem",color:"inherit"}}})})},{field:"created_at",header:"Joined On",sortable:!0,render:t=>e.jsx(a,{variant:"body2",color:"text.secondary",children:new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})})}],h=((O=s==null?void 0:s.data)==null?void 0:O.filter(t=>{var f,m,l;const r=((f=t==null?void 0:t.name)==null?void 0:f.toLowerCase().includes(p.toLowerCase()))||((m=t==null?void 0:t.email)==null?void 0:m.toLowerCase().includes(p.toLowerCase()))||(t==null?void 0:t.nim)&&t.nim.toLowerCase().includes(p.toLowerCase()),n=!g||((l=t==null?void 0:t.role)==null?void 0:l.id)&&t.role.id.toString()===g,C=T===""||T==="active"&&(t==null?void 0:t.is_active)||T==="inactive"&&!(t!=null&&t.is_active);return r&&n&&C}))||[],xe=()=>{if(!h||h.length===0){alert("Tidak ada data untuk diekspor");return}const t=["ID","Nama","Email","NIM","Role","Status","Tanggal Bergabung"],r=h.map(l=>{var Q;return[l.id,l.name||"-",l.email||"-",l.nim||"-",((Q=l.role)==null?void 0:Q.name)||"-",l.is_active?"Active":"Inactive",new Date(l.created_at).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})]}),n=[t.join(","),...r.map(l=>l.join(","))].join(`
`),C=new Blob([n],{type:"text/csv;charset=utf-8;"}),f=URL.createObjectURL(C),m=document.createElement("a");m.setAttribute("href",f),m.setAttribute("download",`users-${new Date().toISOString().split("T")[0]}.csv`),m.style.visibility="hidden",document.body.appendChild(m),m.click(),document.body.removeChild(m)},he=()=>{if(!h||h.length===0){alert("Tidak ada data untuk dicetak");return}const t=`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Daftar Pengguna - ${new Date().toLocaleDateString()}</title>
                <style>
                    body {
                        font-family: Arial, sans-serif;
                        margin: 0;
                        padding: 20px;
                    }
                    h1 {
                        text-align: center;
                        margin-bottom: 20px;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        border: 1px solid #ddd;
                        padding: 8px;
                        text-align: left;
                    }
                    th {
                        background-color: #f2f2f2;
                    }
                    tr:nth-child(even) {
                        background-color: #f9f9f9;
                    }
                    .print-date {
                        text-align: right;
                        margin-bottom: 20px;
                        font-size: 12px;
                    }
                    .status-active {
                        color: green;
                        font-weight: bold;
                    }
                    .status-inactive {
                        color: #757575;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                <div class="print-date">Dicetak pada: ${new Date().toLocaleString()}</div>
                <h1>Daftar Pengguna</h1>
                <table>
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Nama</th>
                            <th>Email</th>
                            <th>NIM</th>
                            <th>Role</th>
                            <th>Status</th>
                            <th>Tanggal Bergabung</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${h.map((n,C)=>{var f;return`
                            <tr>
                                <td>${C+1}</td>
                                <td>${n.name||"-"}</td>
                                <td>${n.email||"-"}</td>
                                <td>${n.nim||"-"}</td>
                                <td>${((f=n.role)==null?void 0:f.name)||"-"}</td>
                                <td class="status-${n.is_active?"active":"inactive"}">${n.is_active?"Active":"Inactive"}</td>
                                <td>${new Date(n.created_at).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}</td>
                            </tr>
                        `}).join("")}
                    </tbody>
                </table>
            </body>
            </html>
        `,r=window.open("","_blank");r.document.write(t),r.document.close(),r.focus(),r.onload=function(){r.print()}},me=t=>e.jsxs(o,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(w,{title:"View Details",children:e.jsx(u,{size:"small",component:X,href:route("admin.users.show",t.id),sx:{color:"#2196f3",bgcolor:i("#2196f3",.1),"&:hover":{bgcolor:i("#2196f3",.2)}},children:e.jsx(ze,{fontSize:"small"})})}),e.jsx(w,{title:"Delete",children:e.jsx(u,{size:"small",onClick:()=>{_(t),I(!0)},sx:{color:"#f44336",bgcolor:i("#f44336",.1),"&:hover":{bgcolor:i("#f44336",.2)}},children:e.jsx(M,{fontSize:"small"})})})]}),F=()=>{B(""),E(""),R(""),N(0)},pe=((H=s==null?void 0:s.data)==null?void 0:H.length)||0,fe=((V=(J=s==null?void 0:s.data)==null?void 0:J.filter(t=>t.is_active))==null?void 0:V.length)||0,be=((Y=(q=s==null?void 0:s.data)==null?void 0:q.filter(t=>!t.is_active))==null?void 0:Y.length)||0;return e.jsxs(Ce,{children:[e.jsx(ge,{title:"Users Management"}),e.jsxs(o,{sx:{mb:4,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(b,{sx:{width:56,height:56,bgcolor:i("#3f51b5",.1),color:"#3f51b5"},children:e.jsx(U,{fontSize:"large"})}),e.jsxs(o,{children:[e.jsx(a,{variant:"h4",component:"h1",fontWeight:700,children:"Users"}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Manage all users in the system"})]})]}),e.jsx(y.div,{whileHover:{scale:1.03},whileTap:{scale:.98},children:e.jsx(A,{variant:"contained",startIcon:e.jsx(Ie,{}),component:X,href:route("admin.users.create"),size:"large",sx:{px:3},children:"Add User"})})]}),e.jsx(ye,{children:ne&&e.jsx(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(we,{severity:se,onClose:()=>S(!1),sx:{mb:3},children:re})})}),e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:3,mb:3},children:[e.jsx(o,{sx:{flex:1,minWidth:"220px",maxWidth:"270px"},children:e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(v,{elevation:0,sx:{display:"flex",alignItems:"center",p:2,borderRadius:2,border:`1px solid ${i("#000",.1)}`,boxShadow:`0 1px 5px ${i("#000",.05)}`,bgcolor:i("#3f51b5",.03)},children:[e.jsx(b,{sx:{bgcolor:i("#3f51b5",.1),color:"#3f51b5",width:56,height:56,mr:2},children:e.jsx(U,{})}),e.jsxs(o,{children:[e.jsx(a,{variant:"h4",fontWeight:700,gutterBottom:!0,children:pe}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Total Users"})]})]})})}),e.jsx(o,{sx:{flex:1,minWidth:"220px",maxWidth:"270px"},children:e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},children:e.jsxs(v,{elevation:0,sx:{display:"flex",alignItems:"center",p:2,borderRadius:2,border:`1px solid ${i("#000",.1)}`,boxShadow:`0 1px 5px ${i("#000",.05)}`,bgcolor:i("#4caf50",.03)},children:[e.jsx(b,{sx:{bgcolor:i("#4caf50",.1),color:"#4caf50",width:56,height:56,mr:2},children:e.jsx(ee,{})}),e.jsxs(o,{children:[e.jsx(a,{variant:"h4",fontWeight:700,gutterBottom:!0,children:fe}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Active Users"})]})]})})}),e.jsx(o,{sx:{flex:1,minWidth:"220px",maxWidth:"270px"},children:e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:e.jsxs(v,{elevation:0,sx:{display:"flex",alignItems:"center",p:2,borderRadius:2,border:`1px solid ${i("#000",.1)}`,boxShadow:`0 1px 5px ${i("#000",.05)}`,bgcolor:i("#9e9e9e",.03)},children:[e.jsx(b,{sx:{bgcolor:i("#9e9e9e",.1),color:"#757575",width:56,height:56,mr:2},children:e.jsx(te,{})}),e.jsxs(o,{children:[e.jsx(a,{variant:"h4",fontWeight:700,gutterBottom:!0,children:be}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Inactive Users"})]})]})})})]}),e.jsxs(v,{elevation:0,sx:{borderRadius:3,boxShadow:"0 2px 10px rgba(0,0,0,0.04)",border:`1px solid ${i("#000",.1)}`,overflow:"hidden",mb:4},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,pl:3,borderBottom:`1px solid ${i("#000",.1)}`},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(U,{color:"primary"}),e.jsx(a,{variant:"h6",fontWeight:600,children:"User Directory"})]}),e.jsxs(o,{children:[e.jsx(w,{title:"Export Users",children:e.jsx(u,{onClick:xe,children:e.jsx(Re,{})})}),e.jsx(w,{title:"Print List",children:e.jsx(u,{onClick:he,children:e.jsx(Ae,{})})}),e.jsx(w,{title:"Refresh",children:e.jsx(u,{onClick:()=>Z.reload(),children:e.jsx(De,{})})})]})]}),e.jsx(o,{sx:{borderBottom:1,borderColor:"divider",px:2},children:e.jsxs(We,{value:z,onChange:le,"aria-label":"user status tabs",sx:{".MuiTabs-indicator":{height:3,borderTopLeftRadius:3,borderTopRightRadius:3},".MuiTab-root":{textTransform:"none",fontWeight:600,px:3,py:1.5}},children:[e.jsx(L,{label:"All Users"}),e.jsx(L,{label:"Active"}),e.jsx(L,{label:"Inactive"})]})}),e.jsx(o,{sx:{p:2,borderBottom:`1px solid ${i("#000",.1)}`},children:e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[e.jsx(o,{sx:{flex:"1 1 300px"},children:e.jsx($e,{fullWidth:!0,placeholder:"Search by name, email, or NIM...",value:p,onChange:t=>B(t.target.value),InputProps:{startAdornment:e.jsx(ke,{position:"start",children:e.jsx(Te,{fontSize:"small"})}),sx:{borderRadius:2,bgcolor:i("#000",.02)}},variant:"outlined",size:"small"})}),e.jsx(o,{sx:{flex:"1 1 200px"},children:e.jsx(Se,{fullWidth:!0,label:"Role",value:g,onChange:t=>E(t.target.value),options:(oe||[]).map(t=>({value:t.id.toString(),label:t.name})),placeholder:"All Roles",showEmpty:!0,size:"small",sx:{borderRadius:2}})}),e.jsx(o,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(w,{title:"Reset all filters",children:e.jsx("span",{children:e.jsx(u,{color:"primary",onClick:F,disabled:!p&&!g&&z===0,size:"small",sx:{border:`1px solid ${i("#3f51b5",.2)}`,borderRadius:2},children:e.jsx(ie,{fontSize:"small"})})})})})]})}),e.jsxs(o,{sx:{px:3,py:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{children:e.jsxs(a,{variant:"body2",color:"text.secondary",children:[h.length," ",h.length===1?"user":"users"," found",p||g||T?" with current filters":""]})}),(p||g||z>0)&&e.jsx(A,{variant:"text",size:"small",startIcon:e.jsx(ie,{fontSize:"small"}),onClick:F,children:"Clear Filters"})]}),e.jsx(o,{sx:{px:2,pb:2},children:e.jsx(v,{elevation:0,sx:{borderRadius:2,border:`1px solid ${i("#000",.1)}`,overflow:"hidden"},children:e.jsx(ue,{data:h,columns:ce,actions:me,pagination:!0,paginationInfo:s==null?void 0:s.meta,baseRoute:"admin.users.index",emptyMessage:"No users found with the current filters.",sx:{".MuiTableHead-root":{bgcolor:i("#3f51b5",.02)},".MuiTableCell-head":{fontWeight:600},".MuiTableRow-root:hover":{bgcolor:i("#3f51b5",.03)}},loading:W})})})]}),e.jsx(ve,{open:ae,onClose:()=>I(!1),title:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(b,{sx:{bgcolor:i("#f44336",.1),color:"#f44336"},children:e.jsx(M,{})}),e.jsx(a,{variant:"h6",component:"h2",fontWeight:600,children:"Confirm Deletion"})]}),contentSx:{p:3,minWidth:{xs:"90vw",sm:400,md:500}},actions:e.jsxs(o,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(A,{variant:"outlined",onClick:()=>I(!1),disabled:W,children:"Cancel"}),e.jsx(y.div,{whileHover:{scale:1.03},whileTap:{scale:.97},children:e.jsx(A,{variant:"contained",color:"error",onClick:de,loading:W,startIcon:e.jsx(M,{}),children:"Delete"})})]}),children:x&&e.jsxs(o,{children:[e.jsx(o,{sx:{p:2,mb:3,bgcolor:i("#f44336",.05),borderRadius:2,border:`1px solid ${i("#f44336",.1)}`},children:e.jsx(a,{variant:"body1",sx:{fontWeight:500},children:"Are you sure you want to delete this user?"})}),e.jsx(v,{elevation:0,sx:{p:2,borderRadius:2,bgcolor:i("#f5f5f5",.4),border:`1px solid ${i("#000",.1)}`,mb:3},children:e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(b,{src:x.avatar,alt:x.name,sx:{width:64,height:64,bgcolor:i("#3f51b5",.1)},children:(G=x.name)==null?void 0:G.charAt(0).toUpperCase()}),e.jsxs(o,{children:[e.jsx(a,{variant:"h6",fontWeight:600,children:x.name}),e.jsx(a,{variant:"body2",color:"text.secondary",children:x.email}),e.jsx(o,{sx:{mt:1},children:e.jsx(D,{label:((K=x.role)==null?void 0:K.name)||"No Role",color:"primary",size:"small",variant:"outlined",sx:{fontWeight:500}})})]})]})}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"This action cannot be undone. All data associated with this user will be permanently deleted, including:"}),e.jsxs(o,{sx:{pl:2,mt:1},children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:"• User profile and account information"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:"• Application history"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:"• Associated files and documents"})]})]})})]})};export{zt as default};
