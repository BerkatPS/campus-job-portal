import{q as de,r as d,j as e,a as me,m as R,b as y,R as pe,J as xe,f as u}from"./app-DbtvrzCH.js";import{L as ue}from"./Layout-nP23ILEi.js";import{h as z}from"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import{u as he,B as n,T as l,a as B,P as ye}from"./Button-B_2tu0cn.js";import{N as f,S as I,A as _}from"./Sidebar-sw6YawgY.js";import{P as je}from"./Person-C1OGobf6.js";import{W as fe,C as g,N as ge}from"./WarningAmber-Czy5P_QB.js";import{E as be}from"./Error-D1IMUwky.js";import{E as ke}from"./Email-Cw9EmbE7.js";import{B as O,W as $,T as S,L as Ce,a as b,b as k,M as T}from"./Work-bK6ZZ-Qp.js";import{E as J}from"./Event-JhFTkm8A.js";import{C as ve}from"./Container-CHMV_DAY.js";import{C as Y,A as Ie}from"./Slide-DsAvN5qg.js";import{F as Se}from"./FilterList-D0xY2zDR.js";import{I as w,L as Te,D as we,M as H}from"./Button-CgCKgwRd.js";import{M as Ae}from"./MoreVert-DyEsPTVO.js";import{T as Me,a as A}from"./Tabs-DDppPwJC.js";import{C as q}from"./Check-DS_0GrJd.js";import{D as K}from"./Delete-DKhiqqSP.js";import{P as We}from"./Pagination-B-ljpO4E.js";import{C as Ne}from"./Card-DBrS13VS.js";import{C as Pe}from"./CardContent-BDcyNa-E.js";import"./Footer-BBk2Lp_N.js";import"./index-BJHsQb-H.js";import"./CheckCircle-nvk-SVVX.js";import"./ChevronRight-Bjx9uoMx.js";import"./Info-j9m1PK-Q.js";import"./People-KxvvNdCJ.js";import"./KeyboardArrowRight-B784So0V.js";import"./LastPage-ByPDXHdv.js";const ma=()=>{var E;const{auth:De,notifications:i,unreadCount:m}=de().props,s=he(),[c,V]=d.useState(0),[M,C]=d.useState(null),[W,v]=d.useState(null),[r,Z]=d.useState("all"),[h,p]=d.useState(!1),[x,j]=d.useState([]);d.useEffect(()=>{if(i&&i.data){const a=i.data.map(t=>{const o=typeof t.data=="string"?JSON.parse(t.data):t.data;return{id:t.id,title:o.title||G(t.type),message:o.message||"",time:z(t.created_at).fromNow(),date:z(t.created_at).format("YYYY-MM-DD"),type:N(t.type),read:t.read_at!==null,icon:Q(t.type),route:o.action_url||"#",action_text:o.action_text||"Lihat Detail",originalData:o}});j(a)}},[i]);const N=a=>a.includes("Job")?"job":a.includes("Application")?"application":a.includes("Interview")?"interview":a.includes("Company")?"company":a.includes("Message")||a.includes("Chat")?"message":a.includes("Forum")?"forum":(a.includes("Welcome")||a.includes("System"),"system"),G=a=>{const t=a.split("\\");return t[t.length-1].replace(/([A-Z])/g," $1").trim()},Q=a=>{switch(N(a)){case"job":return e.jsx($,{});case"application":return e.jsx(_,{});case"interview":return e.jsx(J,{});case"company":return e.jsx(O,{});case"message":return e.jsx(g,{});case"system":return e.jsx(I,{});case"forum":return e.jsx(g,{});case"newsletter":return e.jsx(ke,{});case"error":return e.jsx(be,{});case"warning":return e.jsx(fe,{});case"user":return e.jsx(je,{});default:return e.jsx(f,{})}},U=(a,t)=>{V(t)},X=a=>{C(a.currentTarget)},ee=()=>{C(null)},ae=a=>{v(a.currentTarget)},te=()=>{v(null)},se=a=>{Z(a),v(null)},re=()=>{p(!0),u.post(route("manager.notifications.mark-all-as-read"),{},{onSuccess:()=>{j(x.map(a=>({...a,read:!0}))),C(null)},onFinish:()=>{p(!1)}})},ne=()=>{confirm("Apakah Anda yakin ingin menghapus semua notifikasi?")&&u.reload()},P=a=>{p(!0),u.post(route("manager.notifications.mark-as-read",a),{},{onSuccess:()=>{j(x.map(t=>t.id===a?{...t,read:!0}:t))},onFinish:()=>{p(!1)}})},ie=a=>{p(!0),u.delete(route("manager.notifications.destroy",a),{},{onSuccess:()=>{j(x.filter(t=>t.id!==a))},onFinish:()=>{p(!1)}})},oe=(a,t)=>{u.visit(route("manager.notifications.index",{page:t}),{preserveState:!0,only:["notifications"]})},D=x.filter(a=>c===0?r==="all"||a.type===r:c===1?!a.read&&(r==="all"||a.type===r):a.read&&(r==="all"||a.type===r)),F=[{type:"all",label:"Semua",icon:e.jsx(f,{})},{type:"job",label:"Lowongan",icon:e.jsx($,{})},{type:"application",label:"Lamaran",icon:e.jsx(_,{})},{type:"interview",label:"Interview",icon:e.jsx(J,{})},{type:"company",label:"Perusahaan",icon:e.jsx(O,{})},{type:"message",label:"Pesan",icon:e.jsx(g,{})},{type:"system",label:"Sistem",icon:e.jsx(I,{})},{type:"forum",label:"Forum",icon:e.jsx(g,{})}],le=((E=F.find(a=>a.type===r))==null?void 0:E.label)||"Semua";r==="all"||x.filter(a=>!a.read&&a.type===r).length;const L=a=>{var t;switch(a){case"job":return s.palette.primary.main;case"application":return s.palette.success.main;case"interview":return s.palette.warning.main;case"company":return s.palette.info.main;case"message":return s.palette.secondary.main;case"system":return s.palette.grey[700];case"forum":return((t=s.palette.purple)==null?void 0:t.main)||"#9c27b0";case"error":return s.palette.error.main;default:return s.palette.primary.main}},ce=a=>{a.read||P(a.id),a.route&&a.route!=="#"&&u.visit(a.route)};return e.jsxs(ue,{children:[e.jsx(me,{title:"Notifikasi Manager"}),e.jsxs(ve,{maxWidth:"lg",sx:{py:4},children:[e.jsxs(n,{component:R.div,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},sx:{mb:4},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(f,{fontSize:"large",color:"primary"}),e.jsx(l,{variant:"h4",component:"h1",fontWeight:700,children:"Notifikasi Manager"}),m>0&&e.jsx(Y,{label:`${m} baru`,size:"small",color:"primary",sx:{fontWeight:600,ml:1}})]}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(B,{variant:"outlined",color:"primary",startIcon:e.jsx(Se,{}),onClick:ae,sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:le}),e.jsx(S,{title:"Opsi lainnya",children:e.jsx(w,{onClick:X,children:e.jsx(Ae,{})})})]})]}),e.jsxs(ye,{elevation:0,variant:"outlined",sx:{borderRadius:2,overflow:"hidden"},children:[e.jsxs(Me,{value:c,onChange:U,sx:{borderBottom:`1px solid ${y(s.palette.divider,.1)}`,"& .MuiTab-root":{py:2,textTransform:"none",fontWeight:600,minWidth:100}},children:[e.jsx(A,{label:"Semua"}),e.jsx(A,{label:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(l,{children:"Belum Dibaca"}),m>0&&e.jsx(Y,{label:m,size:"small",color:"primary",sx:{fontWeight:600,height:20,minWidth:20}})]})}),e.jsx(A,{label:"Sudah Dibaca"})]}),h&&e.jsx(n,{sx:{p:4,textAlign:"center"},children:e.jsx(l,{children:"Memuat notifikasi..."})}),!h&&D.length>0?e.jsx(Te,{disablePadding:!0,children:D.map((a,t)=>e.jsxs(pe.Fragment,{children:[t>0&&e.jsx(we,{component:"li"}),e.jsxs(Ce,{sx:{py:2,px:3,backgroundColor:a.read?"transparent":y(s.palette.primary.light,.05),borderLeft:a.read?"none":`4px solid ${s.palette.primary.main}`,transition:"all 0.2s ease","&:hover":{backgroundColor:y(s.palette.primary.light,.1),cursor:"pointer"}},onClick:()=>ce(a),children:[e.jsx(b,{sx:{minWidth:40},children:e.jsx(Ie,{sx:{width:40,height:40,bgcolor:y(L(a.type),.1),color:L(a.type)},children:a.icon})}),e.jsx(k,{primary:e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(l,{variant:"subtitle1",fontWeight:a.read?500:700,children:a.title}),e.jsx(l,{variant:"caption",color:"text.secondary",children:a.time})]}),secondary:e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:a.message}),sx:{my:0}}),e.jsxs(n,{sx:{display:"flex",ml:1},children:[!a.read&&e.jsx(S,{title:"Tandai sudah dibaca",children:e.jsx(w,{size:"small",onClick:o=>{o.stopPropagation(),P(a.id)},sx:{color:s.palette.primary.main},children:e.jsx(q,{fontSize:"small"})})}),e.jsx(S,{title:"Hapus notifikasi",children:e.jsx(w,{size:"small",onClick:o=>{o.stopPropagation(),ie(a.id)},sx:{color:s.palette.error.main},children:e.jsx(K,{fontSize:"small"})})})]})]})]},a.id))}):!h&&e.jsxs(n,{sx:{py:8,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[c===1?e.jsx(ge,{sx:{fontSize:48,color:"text.secondary",mb:2,opacity:.5}}):e.jsx(f,{sx:{fontSize:48,color:"text.secondary",mb:2,opacity:.5}}),e.jsx(l,{variant:"h6",color:"text.secondary",sx:{mb:1},children:c===1?"Tidak ada notifikasi yang belum dibaca":c===2?"Tidak ada notifikasi yang sudah dibaca":"Tidak ada notifikasi"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:c===1?"Semua notifikasi Anda telah dibaca":c===2?"Anda belum memiliki notifikasi yang sudah dibaca":"Anda akan menerima notifikasi tentang lowongan, aplikasi, dan aktivitas lainnya di sini"})]}),i&&i.links&&i.links.length>3&&e.jsx(n,{sx:{p:2,display:"flex",justifyContent:"center",borderTop:`1px solid ${y(s.palette.divider,.1)}`},children:e.jsx(We,{count:Math.ceil(i.total/i.per_page),page:i.current_page,onChange:oe,color:"primary",shape:"rounded"})})]})]}),e.jsx(n,{component:R.div,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:e.jsx(Ne,{variant:"outlined",sx:{borderRadius:2},children:e.jsxs(Pe,{children:[e.jsx(l,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Manajemen Notifikasi"}),e.jsx(l,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Sebagai administrator, Anda dapat mengatur jenis notifikasi yang dikirim ke pengguna. Anda juga dapat melihat riwayat notifikasi sistem di sini."}),e.jsx(B,{variant:"contained",color:"primary",startIcon:e.jsx(I,{}),component:xe,href:route("manager.dashboard"),sx:{borderRadius:2,textTransform:"none",fontWeight:600},children:"Kembali ke Dashboard"})]})})})]}),e.jsxs(H,{anchorEl:M,open:!!M,onClose:ee,PaperProps:{elevation:2,sx:{minWidth:200,borderRadius:2,mt:1,boxShadow:s.shadows[3]}},children:[e.jsxs(T,{onClick:re,sx:{py:1.5},disabled:h||m===0,children:[e.jsx(b,{children:e.jsx(q,{fontSize:"small"})}),e.jsx(k,{primary:"Tandai semua sudah dibaca"})]}),e.jsxs(T,{onClick:ne,sx:{py:1.5},disabled:h||x.length===0,children:[e.jsx(b,{children:e.jsx(K,{fontSize:"small",color:"error"})}),e.jsx(k,{primary:"Hapus semua notifikasi"})]})]}),e.jsx(H,{anchorEl:W,open:!!W,onClose:te,PaperProps:{elevation:2,sx:{minWidth:200,borderRadius:2,mt:1,boxShadow:s.shadows[3]}},children:F.map(a=>e.jsxs(T,{onClick:()=>se(a.type),selected:r===a.type,sx:{py:1.5,borderRadius:1,mx:.5,my:.2},children:[e.jsx(b,{sx:{color:r===a.type?s.palette.primary.main:"inherit"},children:a.icon}),e.jsx(k,{primary:a.label,primaryTypographyProps:{fontWeight:r===a.type?600:400}})]},a.type))})]})};export{ma as default};
