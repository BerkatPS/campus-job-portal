import{j as e,q,r as x,S as M,b as n,a as $,A as V,m as J,J as O}from"./app-DbtvrzCH.js";import{I as h}from"./Input-jLRtBHuK.js";import{B as p}from"./Button-CgCKgwRd.js";import{S as H}from"./Select-GW1WnAoX.js";import{A as G}from"./Alert-BWXyQfZl.js";import{L as K}from"./Layout-nP23ILEi.js";import{c as Q,u as X,B as r,P as g,T as l}from"./Button-B_2tu0cn.js";import{I as u}from"./InputAdornment-Vh23wNde.js";import{P as j}from"./Person-C1OGobf6.js";import{E as Y}from"./Email-Cw9EmbE7.js";import{B as Z}from"./Badge-DGpL2cWn.js";import{L as A}from"./Lock-3pdoyN0_.js";import{I as ee}from"./Info-j9m1PK-Q.js";import{A as b}from"./ArrowBack-BlJGXhv6.js";import{S as P}from"./Sidebar-sw6YawgY.js";import{V as te}from"./VerifiedUser-CriT-yHJ.js";import{F as re}from"./FormControlLabel-DEPIK6dM.js";import{S as ae}from"./Switch-DiBnIsap.js";import{C as oe}from"./CheckCircle-nvk-SVVX.js";import{C as ie}from"./Cancel-BPzKmc0G.js";import{P as se}from"./PhotoCamera-Bsv_N19p.js";import{A as _}from"./Slide-DsAvN5qg.js";import{C as ne}from"./CloudUpload-vL1lrGKt.js";import{S as le}from"./Save-D3JGzUEu.js";import{S as ce,a as me,b as pe}from"./Stepper-DlyzygAA.js";import"./InputLabel-DUQX8vmT.js";import"./TextField-BKjSZQPY.js";import"./Select-DuuFGO1T.js";import"./VisibilityOff-C8adI21A.js";import"./Visibility-7zZFC74a.js";import"./Work-bK6ZZ-Qp.js";import"./Alert-D22fyny9.js";import"./Close-Dpj-0MLQ.js";import"./AlertTitle-CTfZdqfc.js";import"./AccessTime-as3EkDL5.js";import"./ArrowForward-jR7HuMfl.js";import"./Close-BbHhCS19.js";import"./Error-D1IMUwky.js";import"./Warning-CYk4HSbS.js";import"./LinearProgress-Cp3Ye6up.js";import"./Footer-BBk2Lp_N.js";import"./Container-CHMV_DAY.js";import"./index-BJHsQb-H.js";import"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import"./ChevronRight-Bjx9uoMx.js";import"./People-KxvvNdCJ.js";import"./Event-JhFTkm8A.js";import"./SwitchBase-BHRWgqGq.js";const B=Q(e.jsx("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"})),lt=({roles:U=[]})=>{const{auth:de}=q().props,i=X(),[k,y]=x.useState(!1),[D,R]=x.useState(""),[T,z]=x.useState("error"),[v,d]=x.useState(0),[f,S]=x.useState(null),{data:o,setData:c,post:E,processing:F,errors:s}=M({name:"",email:"",password:"",password_confirmation:"",role_id:"",avatar:null,is_active:!0,nim:""}),L=t=>{t.preventDefault();const m=new FormData;Object.keys(o).forEach(a=>{(a==="avatar"&&o[a]!==null||a!=="avatar")&&m.append(a,o[a])}),E(route("admin.users.store"),{data:m,forceFormData:!0,onSuccess:()=>{},onError:a=>{R("Please check the form for errors."),z("error"),y(!0),window.scrollTo(0,0),a.name||a.email||a.nim?d(0):a.password||a.password_confirmation?d(1):(a.role_id||a.avatar)&&d(2)}})},W=t=>{const m=t.target.files[0];if(m){c("avatar",m);const a=new FileReader;a.onload=N=>{S(N.target.result)},a.readAsDataURL(m)}},w=()=>{d(t=>t+1)},I=()=>{d(t=>t-1)},C=[{label:"Basic Information",description:"Enter user basic information",icon:e.jsx(j,{}),content:e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(h,{label:"Full Name",name:"name",value:o.name,onChange:t=>c("name",t.target.value),required:!0,error:s.name,helperText:s.name,fullWidth:!0,placeholder:"Enter user's full name",startAdornment:e.jsx(u,{position:"start",children:e.jsx(j,{color:"primary"})})}),e.jsx(h,{label:"Email Address",name:"email",type:"email",value:o.email,onChange:t=>c("email",t.target.value),required:!0,error:s.email,helperText:s.email,fullWidth:!0,placeholder:"example@email.com",startAdornment:e.jsx(u,{position:"start",children:e.jsx(Y,{color:"primary"})})}),e.jsx(h,{label:"NIM/Student ID",name:"nim",value:o.nim,onChange:t=>c("nim",t.target.value),error:s.nim,helperText:s.nim||"Only required for student accounts",fullWidth:!0,placeholder:"Enter NIM if available",startAdornment:e.jsx(u,{position:"start",children:e.jsx(Z,{color:"primary"})})})]}),e.jsx(r,{sx:{display:"flex",justifyContent:"flex-end",mt:3},children:e.jsx(p,{onClick:w,variant:"contained",endIcon:e.jsx(B,{}),children:"Next: Security"})})]})},{label:"Security",description:"Set user password",icon:e.jsx(B,{}),content:e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(h,{label:"Password",name:"password",type:"password",value:o.password,onChange:t=>c("password",t.target.value),required:!0,error:s.password,helperText:s.password||"Minimum 8 characters",fullWidth:!0,startAdornment:e.jsx(u,{position:"start",children:e.jsx(A,{color:"primary"})})}),e.jsx(h,{label:"Confirm Password",name:"password_confirmation",type:"password",value:o.password_confirmation,onChange:t=>c("password_confirmation",t.target.value),required:!0,error:s.password_confirmation,helperText:s.password_confirmation,fullWidth:!0,startAdornment:e.jsx(u,{position:"start",children:e.jsx(A,{color:"primary"})})})]}),e.jsxs(g,{elevation:0,sx:{mt:3,p:2,bgcolor:n(i.palette.info.main,.05),border:`1px solid ${n(i.palette.info.main,.1)}`,borderRadius:2,display:"flex",alignItems:"flex-start",gap:1.5},children:[e.jsx(ee,{color:"info",sx:{mt:.5}}),e.jsxs(r,{children:[e.jsx(l,{variant:"subtitle2",color:"info.main",gutterBottom:!0,children:"Password Security Tips"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Use a combination of uppercase letters, lowercase letters, numbers, and symbols for a strong password. Avoid using easily guessable personal information like birth dates."})]})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mt:3},children:[e.jsx(p,{onClick:I,variant:"outlined",startIcon:e.jsx(b,{}),children:"Back"}),e.jsx(p,{onClick:w,variant:"contained",endIcon:e.jsx(P,{}),children:"Next: Settings"})]})]})},{label:"Settings",description:"Choose role and profile photo",icon:e.jsx(P,{}),content:e.jsxs(r,{children:[e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(r,{sx:{mb:3},children:[e.jsxs(l,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(te,{fontSize:"small",color:"primary"}),"Role & Status"]}),e.jsx(H,{label:"User Role",name:"role_id",value:o.role_id,onChange:t=>c("role_id",t.target.value),options:(U||[]).map(t=>({value:t.id.toString(),label:t.name})),required:!0,error:s.role_id,helperText:s.role_id||"Select an appropriate role for this user"}),e.jsxs(r,{sx:{mt:3,p:2,border:`1px solid ${n(i.palette.divider,.1)}`,borderRadius:2,bgcolor:n(i.palette.background.paper,.5)},children:[e.jsx(re,{control:e.jsx(ae,{checked:o.is_active,onChange:t=>c("is_active",t.target.checked),color:"success"}),label:"Active Account"}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{display:"block",ml:2},children:"Inactive accounts cannot log into the system"}),e.jsx(r,{sx:{mt:1,p:1,bgcolor:o.is_active?n(i.palette.success.main,.05):n(i.palette.error.main,.05),borderRadius:1,border:`1px solid ${o.is_active?n(i.palette.success.main,.1):n(i.palette.error.main,.1)}`},children:e.jsx(l,{variant:"caption",color:"text.secondary",sx:{display:"flex",alignItems:"center",gap:.5},children:o.is_active?e.jsxs(e.Fragment,{children:[e.jsx(oe,{fontSize:"inherit",color:"success"}),"User can immediately log in after creation"]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{fontSize:"inherit",color:"error"}),"User cannot log in until account is activated"]})})})]})]}),e.jsxs(r,{sx:{mb:3},children:[e.jsxs(l,{variant:"subtitle1",fontWeight:600,gutterBottom:!0,sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(se,{fontSize:"small",color:"primary"}),"Profile Photo"]}),e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",mt:2},children:[e.jsx(_,{src:f,alt:o.name||"Preview",sx:{width:120,height:120,mb:2,fontSize:"3rem",bgcolor:f?"transparent":n(i.palette.primary.main,.1),color:i.palette.primary.main,border:`4px solid ${n(i.palette.primary.main,.1)}`},children:!f&&(o.name?o.name.charAt(0).toUpperCase():e.jsx(j,{sx:{fontSize:60}}))}),e.jsxs(r,{children:[e.jsx("input",{id:"avatar-upload",type:"file",accept:"image/*",hidden:!0,onChange:W}),e.jsx(p,{component:"label",htmlFor:"avatar-upload",variant:"outlined",startIcon:e.jsx(ne,{}),children:"Upload Photo"})]}),s.avatar&&e.jsx(l,{variant:"caption",color:"error",sx:{mt:1},children:s.avatar}),e.jsx(l,{variant:"caption",color:"text.secondary",sx:{mt:1},children:"Upload profile photo (max 2MB)"}),f&&e.jsx(p,{variant:"text",color:"error",size:"small",onClick:()=>{S(null),c("avatar",null)},sx:{mt:1},children:"Remove Photo"})]})]})]}),e.jsxs(r,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[e.jsx(p,{onClick:I,variant:"outlined",startIcon:e.jsx(b,{}),children:"Back"}),e.jsx(p,{type:"submit",variant:"contained",color:"primary",startIcon:e.jsx(le,{}),loading:F,children:"Create User"})]})]})}];return e.jsxs(K,{children:[e.jsx($,{title:"Create New User"}),e.jsx(V,{children:k&&e.jsx(J.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(G,{severity:T,onClose:()=>y(!1),sx:{mb:3},children:D})})}),e.jsxs(r,{sx:{mb:4,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(_,{sx:{width:56,height:56,bgcolor:n(i.palette.primary.main,.1),color:i.palette.primary.main},children:e.jsx(j,{fontSize:"large"})}),e.jsxs(r,{children:[e.jsx(l,{variant:"h4",component:"h1",fontWeight:700,children:"Create New User"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Add a new user to the system"})]})]}),e.jsx(p,{variant:"outlined",startIcon:e.jsx(b,{}),component:O,href:route("admin.users.index"),children:"Back to Users List"})]}),e.jsx(g,{elevation:0,sx:{p:2,mb:3,borderRadius:3,boxShadow:"0 2px 10px rgba(0,0,0,0.04)",border:`1px solid ${n(i.palette.divider,.1)}`},children:e.jsx(ce,{activeStep:v,alternativeLabel:!0,children:C.map((t,m)=>e.jsx(me,{children:e.jsxs(pe,{StepIconProps:{icon:t.icon,sx:{color:v>=m?i.palette.primary.main:void 0}},children:[e.jsx(l,{variant:"subtitle2",fontWeight:600,children:t.label}),e.jsx(l,{variant:"caption",color:"text.secondary",children:t.description})]})},t.label))})}),e.jsx(r,{component:"form",onSubmit:L,children:e.jsx(g,{elevation:0,sx:{p:3,borderRadius:3,boxShadow:"0 2px 10px rgba(0,0,0,0.04)",border:`1px solid ${n(i.palette.divider,.1)}`,mb:3},children:e.jsx(r,{children:C[v].content})})})]})};export{lt as default};
