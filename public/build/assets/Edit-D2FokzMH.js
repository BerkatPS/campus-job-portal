import{j as e,q as w,r as l,S as B,a as E,J as T}from"./app-DbtvrzCH.js";import{C as k}from"./Card-CO4m9eOz.js";import{B as m,D}from"./Button-CgCKgwRd.js";import{I as p}from"./Input-jLRtBHuK.js";import{F as c}from"./FormGroup-1loQCr0P.js";import{S as U}from"./Select-GW1WnAoX.js";import{F}from"./FileUpload-BY7fOnaX.js";import{C as M}from"./Checkbox-BoxgtzbF.js";import{A as L}from"./Alert-BWXyQfZl.js";import{L as N}from"./Layout-nP23ILEi.js";import{c as W,B as n}from"./Button-B_2tu0cn.js";import{P as _}from"./Person-C1OGobf6.js";import{E as q}from"./Email-Cw9EmbE7.js";import{B as R}from"./Badge-DGpL2cWn.js";import{L as y}from"./Lock-3pdoyN0_.js";import{A as z}from"./Slide-DsAvN5qg.js";import{S as J}from"./Save-D3JGzUEu.js";import{A as $}from"./ArrowBack-BlJGXhv6.js";import"./Card-DBrS13VS.js";import"./MoreVert-DyEsPTVO.js";import"./CardHeader-iJjJx4bi.js";import"./CardContent-BDcyNa-E.js";import"./InputLabel-DUQX8vmT.js";import"./TextField-BKjSZQPY.js";import"./Select-DuuFGO1T.js";import"./InputAdornment-Vh23wNde.js";import"./VisibilityOff-C8adI21A.js";import"./Visibility-7zZFC74a.js";import"./Info-j9m1PK-Q.js";import"./Work-bK6ZZ-Qp.js";import"./LinearProgress-Cp3Ye6up.js";import"./CloudUpload-vL1lrGKt.js";import"./Upload-B7qw_qx9.js";import"./Alert-D22fyny9.js";import"./Close-Dpj-0MLQ.js";import"./Error-D1IMUwky.js";import"./Check-DS_0GrJd.js";import"./Delete-DKhiqqSP.js";import"./PictureAsPdf-D2_5a5_Z.js";import"./Description-Z4oGvRZp.js";import"./InsertDriveFile-DWL1oYxZ.js";import"./FormControlLabel-DEPIK6dM.js";import"./Checkbox-D9hSuJOi.js";import"./SwitchBase-BHRWgqGq.js";import"./AlertTitle-CTfZdqfc.js";import"./AccessTime-as3EkDL5.js";import"./ArrowForward-jR7HuMfl.js";import"./Close-BbHhCS19.js";import"./Warning-CYk4HSbS.js";import"./CheckCircle-nvk-SVVX.js";import"./Sidebar-sw6YawgY.js";import"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import"./index-BJHsQb-H.js";import"./Container-CHMV_DAY.js";import"./ChevronRight-Bjx9uoMx.js";import"./People-KxvvNdCJ.js";import"./Event-JhFTkm8A.js";import"./Footer-BBk2Lp_N.js";const G=W(e.jsx("path",{d:"M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),Yt=({user:t={},roles:C=[]})=>{const{auth:H}=w().props,[b,s]=l.useState(!1),[I,d]=l.useState(""),[S,x]=l.useState("error"),[h,f]=l.useState(!1),{data:i,setData:r,post:P,processing:v,errors:o}=B({_method:"PUT",name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",password:"",password_confirmation:"",role_id:(t==null?void 0:t.role_id)||"",avatar:null,is_active:(t==null?void 0:t.is_active)||!1,nim:(t==null?void 0:t.nim)||""});l.useEffect(()=>{const{flash:a}=w().props;if(a!=null&&a.message){d(a.message),x(a.type||"success"),s(!0);const j=setTimeout(()=>{s(!1)},5e3);return()=>clearTimeout(j)}},[]);const u=a=>{a.preventDefault(),P(route("admin.users.update",t==null?void 0:t.id),{onSuccess:()=>{d("User updated successfully."),x("success"),s(!0)},onError:j=>{d("Please check the form for errors."),x("error"),s(!0),window.scrollTo(0,0)}})},A=a=>{r("avatar",a.target.files[0])},g=()=>{f(!h),h||r({...i,password:"",password_confirmation:""})};return e.jsxs(N,{children:[e.jsx(E,{title:`Edit User: ${(t==null?void 0:t.name)||""}`}),b&&e.jsx(L,{severity:S,onClose:()=>s(!1),sx:{mb:2},children:I}),e.jsx(k,{title:`Edit User: ${(t==null?void 0:t.name)||""}`,icon:e.jsx(_,{}),action:e.jsx(m,{variant:"outlined",startIcon:e.jsx($,{}),component:T,href:route("admin.users.index"),children:"Back to Users"}),children:e.jsxs(n,{component:"form",onSubmit:u,sx:{display:"flex",flexDirection:"column"},children:[e.jsx(c,{label:"Basic Information",marginBottom:"large",children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(p,{label:"Full Name",name:"name",value:i.name,onChange:a=>r("name",a.target.value),required:!0,error:o.name,helperText:o.name,fullWidth:!0,placeholder:"Enter user's full name",startIcon:e.jsx(_,{})}),e.jsxs(n,{sx:{display:"flex",gap:2},children:[e.jsx(p,{label:"Email Address",name:"email",type:"email",value:i.email,onChange:a=>r("email",a.target.value),required:!0,error:o.email,helperText:o.email,fullWidth:!0,placeholder:"Enter email address",startIcon:e.jsx(q,{})}),e.jsx(p,{label:"NIM/Student ID",name:"nim",value:i.nim,onChange:a=>r("nim",a.target.value),error:o.nim,helperText:o.nim||"Only needed for student accounts",fullWidth:!0,placeholder:"Enter NIM if applicable",startIcon:e.jsx(R,{})})]})]})}),h?e.jsx(c,{label:"Update Password",marginBottom:"large",children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(p,{label:"New Password",name:"password",type:"password",value:i.password,onChange:a=>r("password",a.target.value),error:o.password,helperText:o.password||"Leave blank to keep current password",fullWidth:!0,startIcon:e.jsx(y,{})}),e.jsx(p,{label:"Confirm New Password",name:"password_confirmation",type:"password",value:i.password_confirmation,onChange:a=>r("password_confirmation",a.target.value),error:o.password_confirmation,helperText:o.password_confirmation,fullWidth:!0,startIcon:e.jsx(y,{})}),e.jsx(m,{variant:"text",color:"primary",onClick:g,size:"small",children:"Cancel Password Change"})]})}):e.jsx(n,{sx:{mb:3},children:e.jsx(m,{variant:"outlined",color:"primary",onClick:g,startIcon:e.jsx(G,{}),children:"Change Password"})}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(c,{label:"Profile Picture",marginBottom:"large",children:[(t==null?void 0:t.avatar)&&e.jsx(n,{sx:{mb:2,display:"flex",justifyContent:"center"},children:e.jsx(z,{src:t.avatar,alt:(t==null?void 0:t.name)||"",sx:{width:120,height:120,mb:2}})}),e.jsx(F,{name:"avatar",accept:"image/*",maxSize:2,onChange:A,error:o.avatar,helperText:o.avatar||"Upload new profile picture to replace the current one (max 2MB)",dragAndDrop:!0,showPreview:!0})]}),e.jsxs(c,{label:"Role & Status",marginBottom:"large",children:[e.jsx(U,{label:"Role",name:"role_id",value:i.role_id,onChange:a=>r("role_id",a.target.value),options:(C||[]).map(a=>({value:a.id,label:a.name,description:a.description})),required:!0,error:o.role_id,helperText:o.role_id}),e.jsx(M,{label:"Active Account",name:"is_active",checked:i.is_active,onChange:a=>r("is_active",a.target.checked),helperText:"Inactive accounts cannot log in to the system"})]})]}),e.jsx(D,{sx:{my:3}}),e.jsxs(n,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(m,{type:"button",variant:"outlined",onClick:()=>{r({_method:"PUT",name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",password:"",password_confirmation:"",role_id:(t==null?void 0:t.role_id)||"",avatar:null,is_active:(t==null?void 0:t.is_active)||!1,nim:(t==null?void 0:t.nim)||""}),f(!1)},disabled:v,children:"Reset"}),e.jsx(m,{type:"submit",variant:"contained",startIcon:e.jsx(J,{}),loading:v,children:"Save Changes"})]})]})})]})};export{Yt as default};
