import{r as a,q as M,j as e,M as S,C as H,e as T,b as p,m as b}from"./app-BUVb_nAj.js";import{H as V,a as L}from"./Sidebar-DGzgELZX.js";import{F as N}from"./Footer-DSErbOqA.js";import{u as F,B as v,C as $}from"./Button-DFxjcZ8p.js";import{u as B}from"./index-Dtg-WGcE.js";import{a as I}from"./Button-DzGhUBn7.js";function W({userId:i}){return a.useEffect(()=>{if(console.log("NotificationListener mounted with userId:",i),!i){console.warn("NotificationListener: No userId provided");return}if(!window.Echo){console.error("NotificationListener: Echo is not initialized");return}console.log("Setting up notification listener for user:",i);const r=window.Echo.private(`App.Models.User.${i}`);return r.notification(o=>{var g,l,f,t,s,u,h,c;if(console.log("ðŸ”” New notification received:",o),window.dispatchEvent(new CustomEvent("notification.received",{detail:o})),window.showToast){let d="info",m="Pemberitahuan baru diterima";(g=o.data)!=null&&g.message&&(m=o.data.message),((l=o.data)==null?void 0:l.icon)==="success"||(f=o.type)!=null&&f.includes("Success")?d="success":((t=o.data)==null?void 0:t.icon)==="error"||(s=o.type)!=null&&s.includes("Error")?d="error":(((u=o.data)==null?void 0:u.icon)==="warning"||(h=o.type)!=null&&h.includes("Warning"))&&(d="warning"),(c=o.data)!=null&&c.title&&(m=`${o.data.title}: ${m}`),window.showToast({message:m,type:d,duration:7e3})}}),r.error(o=>{console.error("Channel error:",o)}),console.log("âœ… Notification listener setup complete"),()=>{console.log("NotificationListener unmounting, leaving channel"),window.Echo.leave(`App.Models.User.${i}`)}},[i]),null}const P=({open:i})=>e.jsxs(I,{sx:{color:"#fff",zIndex:r=>r.zIndex.drawer+1,backdropFilter:"blur(8px)",backgroundColor:p("#000000",.6),display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},open:i,children:[e.jsx(b.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:e.jsx($,{color:"primary",size:60,thickness:4,sx:{"& .MuiCircularProgress-circle":{strokeLinecap:"round"}}})}),e.jsx(b.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{duration:.3,delay:.2},children:e.jsx(v,{sx:{mt:2,fontWeight:"medium",fontSize:"1rem"},children:"Loading..."})})]}),G=({children:i})=>{var w;const{auth:r}=M().props,[o,g]=a.useState(!1),[l,f]=a.useState("light"),t=F(),s=B(t.breakpoints.down("lg")),[u,h]=a.useState(!s),[c,d]=a.useState(s),[m,C]=a.useState(!1);a.useEffect(()=>{const n=()=>{window.Echo?(console.log("Echo is initialized"),C(!0)):(console.log("Waiting for Echo..."),setTimeout(n,100))};n()},[]),a.useEffect(()=>{h(!s),d(s)},[s]),a.useEffect(()=>{g(!0);const n=setTimeout(()=>{g(!1)},300);return()=>clearTimeout(n)},[]);const E=()=>{h(!u)},y=()=>{d(!c)},k=()=>{f(n=>n==="light"?"dark":"light")},x=c?72:280,j=s?"100%":`calc(100% - ${x}px)`,z=s?0:`${x}px`;return e.jsx(S,{children:e.jsxs(v,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",bgcolor:"background.default",transition:"background-color 0.3s ease",position:"relative"},children:[e.jsx(H,{}),e.jsx(v,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:0,opacity:.02,backgroundImage:l==="light"?`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23${t.palette.primary.main.replace("#","")}' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23FFFFFF' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`,pointerEvents:"none"}}),e.jsx(P,{open:o}),e.jsx(T,{}),((w=r==null?void 0:r.user)==null?void 0:w.id)&&e.jsx(W,{userId:r.user.id}),e.jsx(V,{toggleSidebar:E,onThemeToggle:k,mode:l,sidebarCollapsed:c}),e.jsxs(v,{sx:{display:"flex",flex:1,overflow:"hidden",position:"relative",zIndex:1},children:[e.jsx(L,{isOpen:u,onClose:()=>h(!1),collapsed:c,toggleCollapsed:y,mode:l,sx:{zIndex:n=>n.zIndex.appBar+1}}),e.jsxs(v,{component:"main",sx:{flexGrow:1,mt:"64px",width:j,ml:z,height:"calc(100vh - 64px)",overflow:"auto",transition:t.transitions.create(["width","margin-left"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen}),scrollbarWidth:"thin",scrollbarColor:`${p(t.palette.primary.main,.2)} ${p(t.palette.background.paper,.1)}`,"&::-webkit-scrollbar":{width:"8px",height:"8px"},"&::-webkit-scrollbar-thumb":{backgroundColor:p(t.palette.primary.main,.2),borderRadius:"4px","&:hover":{backgroundColor:p(t.palette.primary.main,.3)}},"&::-webkit-scrollbar-track":{backgroundColor:p(t.palette.background.paper,.1)}},className:"custom-scrollbar",children:[i,e.jsx(N,{mode:l})]})]})]})})};export{G as L};
