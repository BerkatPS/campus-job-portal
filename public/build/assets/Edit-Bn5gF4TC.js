import{j as e,q as w,r as l,S as B,a as E,J as T}from"./app-BUVb_nAj.js";import{C as k}from"./Card-vSg9PuMO.js";import{B as m,D}from"./Button-DzGhUBn7.js";import{I as p}from"./Input-CZ4N0rVB.js";import{F as c}from"./FormGroup-DX6tnawx.js";import{S as U}from"./Select-CwiaD0cR.js";import{F}from"./FileUpload-CwAWv9wr.js";import{C as M}from"./Checkbox-DFrHN2i9.js";import{A as L}from"./Alert-W_CUoSxB.js";import{L as N}from"./Layout-DnkF-NCm.js";import{c as W,B as n}from"./Button-DFxjcZ8p.js";import{P as _}from"./Person-5k5xBlAT.js";import{E as q}from"./Email-E4u4F7F-.js";import{B as R}from"./Badge-CTB2DnIA.js";import{L as y}from"./Lock-fWVfVfzM.js";import{A as z}from"./Slide-DYtCGdXj.js";import{S as J}from"./Save-JdvVwzrr.js";import{A as $}from"./ArrowBack-Cgi6G0-j.js";import"./Card-D_rkxkaC.js";import"./MoreVert-PY4ZbxeC.js";import"./CardHeader-D023TrKm.js";import"./CardContent-DTmJK9ga.js";import"./InputLabel-DpN5m5Yk.js";import"./TextField-DdsD0Afg.js";import"./Select-Bh9V9k3o.js";import"./InputAdornment-CzgX0339.js";import"./VisibilityOff-BgFPuDcZ.js";import"./Visibility-clJeQAT9.js";import"./Info-CdM9Lqya.js";import"./Work-CLEsMByH.js";import"./LinearProgress-3EBWbMR1.js";import"./CloudUpload-CD8KO2hp.js";import"./Upload-M5XxF891.js";import"./Alert-j9c9aQEr.js";import"./Close-CafbgWA1.js";import"./Error-CSPDIC8t.js";import"./Check-4ptu1-hL.js";import"./Delete-DjrVMKuP.js";import"./PictureAsPdf-Yr8idwAW.js";import"./Description-bLLwqFxn.js";import"./InsertDriveFile-BNg7U0hV.js";import"./FormControlLabel-DTCfN-Gd.js";import"./Checkbox-DZaxlRGh.js";import"./SwitchBase-BRw57M3-.js";import"./AlertTitle-CPDkbCwY.js";import"./AccessTime-DXhpyso9.js";import"./ArrowForward-Tz2ikYxH.js";import"./Close-B7UDIhaS.js";import"./Warning-BLg7sOqp.js";import"./CheckCircle-Dd-oaFV0.js";import"./Sidebar-DGzgELZX.js";import"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import"./index-Dtg-WGcE.js";import"./Container-DEvTfuj0.js";import"./ChevronRight-FNylUib_.js";import"./People-6TwBzk5z.js";import"./Event-DRCIx1GO.js";import"./Footer-DSErbOqA.js";const G=W(e.jsx("path",{d:"M12.65 10C11.83 7.67 9.61 6 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6c2.61 0 4.83-1.67 5.65-4H17v4h4v-4h2v-4zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2"})),Yt=({user:t={},roles:C=[]})=>{const{auth:H}=w().props,[b,s]=l.useState(!1),[I,d]=l.useState(""),[S,x]=l.useState("error"),[h,f]=l.useState(!1),{data:i,setData:r,post:P,processing:v,errors:o}=B({_method:"PUT",name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",password:"",password_confirmation:"",role_id:(t==null?void 0:t.role_id)||"",avatar:null,is_active:(t==null?void 0:t.is_active)||!1,nim:(t==null?void 0:t.nim)||""});l.useEffect(()=>{const{flash:a}=w().props;if(a!=null&&a.message){d(a.message),x(a.type||"success"),s(!0);const j=setTimeout(()=>{s(!1)},5e3);return()=>clearTimeout(j)}},[]);const u=a=>{a.preventDefault(),P(route("admin.users.update",t==null?void 0:t.id),{onSuccess:()=>{d("User updated successfully."),x("success"),s(!0)},onError:j=>{d("Please check the form for errors."),x("error"),s(!0),window.scrollTo(0,0)}})},A=a=>{r("avatar",a.target.files[0])},g=()=>{f(!h),h||r({...i,password:"",password_confirmation:""})};return e.jsxs(N,{children:[e.jsx(E,{title:`Edit User: ${(t==null?void 0:t.name)||""}`}),b&&e.jsx(L,{severity:S,onClose:()=>s(!1),sx:{mb:2},children:I}),e.jsx(k,{title:`Edit User: ${(t==null?void 0:t.name)||""}`,icon:e.jsx(_,{}),action:e.jsx(m,{variant:"outlined",startIcon:e.jsx($,{}),component:T,href:route("admin.users.index"),children:"Back to Users"}),children:e.jsxs(n,{component:"form",onSubmit:u,sx:{display:"flex",flexDirection:"column"},children:[e.jsx(c,{label:"Basic Information",marginBottom:"large",children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(p,{label:"Full Name",name:"name",value:i.name,onChange:a=>r("name",a.target.value),required:!0,error:o.name,helperText:o.name,fullWidth:!0,placeholder:"Enter user's full name",startIcon:e.jsx(_,{})}),e.jsxs(n,{sx:{display:"flex",gap:2},children:[e.jsx(p,{label:"Email Address",name:"email",type:"email",value:i.email,onChange:a=>r("email",a.target.value),required:!0,error:o.email,helperText:o.email,fullWidth:!0,placeholder:"Enter email address",startIcon:e.jsx(q,{})}),e.jsx(p,{label:"NIM/Student ID",name:"nim",value:i.nim,onChange:a=>r("nim",a.target.value),error:o.nim,helperText:o.nim||"Only needed for student accounts",fullWidth:!0,placeholder:"Enter NIM if applicable",startIcon:e.jsx(R,{})})]})]})}),h?e.jsx(c,{label:"Update Password",marginBottom:"large",children:e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(p,{label:"New Password",name:"password",type:"password",value:i.password,onChange:a=>r("password",a.target.value),error:o.password,helperText:o.password||"Leave blank to keep current password",fullWidth:!0,startIcon:e.jsx(y,{})}),e.jsx(p,{label:"Confirm New Password",name:"password_confirmation",type:"password",value:i.password_confirmation,onChange:a=>r("password_confirmation",a.target.value),error:o.password_confirmation,helperText:o.password_confirmation,fullWidth:!0,startIcon:e.jsx(y,{})}),e.jsx(m,{variant:"text",color:"primary",onClick:g,size:"small",children:"Cancel Password Change"})]})}):e.jsx(n,{sx:{mb:3},children:e.jsx(m,{variant:"outlined",color:"primary",onClick:g,startIcon:e.jsx(G,{}),children:"Change Password"})}),e.jsxs(n,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(c,{label:"Profile Picture",marginBottom:"large",children:[(t==null?void 0:t.avatar)&&e.jsx(n,{sx:{mb:2,display:"flex",justifyContent:"center"},children:e.jsx(z,{src:t.avatar,alt:(t==null?void 0:t.name)||"",sx:{width:120,height:120,mb:2}})}),e.jsx(F,{name:"avatar",accept:"image/*",maxSize:2,onChange:A,error:o.avatar,helperText:o.avatar||"Upload new profile picture to replace the current one (max 2MB)",dragAndDrop:!0,showPreview:!0})]}),e.jsxs(c,{label:"Role & Status",marginBottom:"large",children:[e.jsx(U,{label:"Role",name:"role_id",value:i.role_id,onChange:a=>r("role_id",a.target.value),options:(C||[]).map(a=>({value:a.id,label:a.name,description:a.description})),required:!0,error:o.role_id,helperText:o.role_id}),e.jsx(M,{label:"Active Account",name:"is_active",checked:i.is_active,onChange:a=>r("is_active",a.target.checked),helperText:"Inactive accounts cannot log in to the system"})]})]}),e.jsx(D,{sx:{my:3}}),e.jsxs(n,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(m,{type:"button",variant:"outlined",onClick:()=>{r({_method:"PUT",name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",password:"",password_confirmation:"",role_id:(t==null?void 0:t.role_id)||"",avatar:null,is_active:(t==null?void 0:t.is_active)||!1,nim:(t==null?void 0:t.nim)||""}),f(!1)},disabled:v,children:"Reset"}),e.jsx(m,{type:"submit",variant:"contained",startIcon:e.jsx(J,{}),loading:v,children:"Save Changes"})]})]})})]})};export{Yt as default};
