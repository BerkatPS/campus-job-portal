import{q as be,r as d,f as C,j as e,a as Se,J as ee,b as y,m as te}from"./app-BUVb_nAj.js";import{h as v}from"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import{L as Te}from"./Layout-DnkF-NCm.js";import{P as De}from"./Pagination-DLFQ9JGy.js";import{S as R}from"./sweetalert2.esm.all-DV3w3JmD.js";import{u as P,B as n,T as c,a as B,P as j}from"./Button-DFxjcZ8p.js";import{C as Ie}from"./Container-DEvTfuj0.js";import{F as Me}from"./FilterList-Cvii7KUK.js";import{A as Le}from"./Add-Dwuu4lJj.js";import{W as ae,S as Ae,T as F,M,a as _,b as $}from"./Work-CLEsMByH.js";import{C as Ye}from"./CheckCircleOutline-y6eVAwYo.js";import{D as ze}from"./DoDisturbOn-ADLHS0oN.js";import{T as Re,a as E}from"./Tabs-CQDMEBQN.js";import{T as Pe}from"./TextField-DdsD0Afg.js";import{I as Be}from"./InputAdornment-CzgX0339.js";import{I as k,M as re,D as Fe}from"./Button-DzGhUBn7.js";import{F as ne}from"./FilterAlt-D2Yj-2Tu.js";import{T as _e,a as $e,b as Ee,c as W,d as m,e as We}from"./TableRow-BgPH6iWY.js";import{C as oe,A as ie}from"./Slide-DYtCGdXj.js";import{E as Je}from"./Edit-D-W3BsdZ.js";import{D as se}from"./Delete-DjrVMKuP.js";import{M as le}from"./MoreVert-PY4ZbxeC.js";import{C as Oe}from"./Card-D_rkxkaC.js";import{L as He}from"./LocationOn-CpujyWrU.js";import{C as Ve}from"./CalendarToday-CUHpeiFE.js";import{M as Ge}from"./MonetizationOn-uOibzMZ9.js";import{C as Ne}from"./CloudDownload-BKqs_LW6.js";import{P as Ke}from"./Print-C4-INZY1.js";import{R as Ue}from"./Sidebar-DGzgELZX.js";import"./Footer-DSErbOqA.js";import"./index-Dtg-WGcE.js";import"./KeyboardArrowLeft-CAm5v7jB.js";import"./ButtonGroup-BUsgIcyn.js";import"./Stack-DUsTNRwi.js";import"./InputLabel-DpN5m5Yk.js";import"./Select-Bh9V9k3o.js";import"./KeyboardArrowRight-By3nsvSL.js";import"./CheckCircle-Dd-oaFV0.js";import"./ChevronRight-FNylUib_.js";import"./Person-5k5xBlAT.js";import"./Info-CdM9Lqya.js";import"./People-6TwBzk5z.js";import"./Event-DRCIx1GO.js";v.locale("id");const Ht=({jobs:r,filters:J,categories:qe})=>{var Z;const{auth:Qe}=be().props,u=P(),[p,O]=d.useState(J.search||""),[b,w]=d.useState(null),[H,V]=d.useState(null),[de,Xe]=d.useState("list"),[Ze,G]=d.useState(!1),[x,S]=d.useState(J.status||""),[L,N]=d.useState(x==="active"?1:x==="closed"?2:0),[ce,K]=d.useState(null),me=d.useMemo(()=>{var t;return(r==null?void 0:r.total)||((t=r==null?void 0:r.data)==null?void 0:t.length)||0},[r]),pe=d.useMemo(()=>{var t,a;return((a=(t=r==null?void 0:r.data)==null?void 0:t.filter(o=>o.status==="active"))==null?void 0:a.length)||0},[r]),xe=d.useMemo(()=>{var t,a;return((a=(t=r==null?void 0:r.data)==null?void 0:t.filter(o=>o.status==="closed"))==null?void 0:a.length)||0},[r]);d.useMemo(()=>!(r!=null&&r.data)||!Array.isArray(r.data)?[]:[...r.data],[r==null?void 0:r.data]);const he=(t,a)=>{N(a),a===0?S(""):a===1?S("active"):a===2&&S("closed")};d.useEffect(()=>{if(r!=null&&r.data&&(p||x)){const t={...route().params};p?t.search=p:delete t.search,x?t.status=x:delete t.status,t.page=1,C.get(route("admin.jobs.index",t),{},{preserveState:!0,replace:!0,only:["jobs"]})}},[p,x]);const A=()=>{O(""),S(""),N(0),C.get(route("admin.jobs.index"),{},{preserveState:!1,only:["jobs"]})},U=t=>{w(t),R.fire({title:"Konfirmasi Hapus",text:`Apakah Anda yakin ingin menghapus lowongan ${t.title}? Tindakan ini tidak dapat dibatalkan dan akan menghapus semua data terkait lowongan ini.`,icon:"warning",showCancelButton:!0,confirmButtonColor:u.palette.error.main,cancelButtonColor:u.palette.grey[500],confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(a=>{a.isConfirmed?ge():w(null)})},q=(t,a)=>{V(t.currentTarget),w(a)},Q=()=>{V(null),w(null)},ue=t=>{K(t.currentTarget)},fe=()=>{K(null)},ge=()=>{b&&(G(!0),C.delete(route("admin.jobs.destroy",b.id),{onSuccess:t=>{const a=t.props.flash&&t.props.flash.message?t.props.flash.message:"Lowongan berhasil dihapus";R.fire({title:"Berhasil!",text:a,icon:"success",confirmButtonText:"OK",confirmButtonColor:u.palette.primary.main}),w(null),C.reload({only:["jobs"]})},onError:t=>{console.error("Error deleting job:",t);let a="Gagal menghapus lowongan: Terjadi kesalahan";t.message?a=t.message:t.errors&&Object.keys(t.errors).length>0&&(a=`Gagal menghapus lowongan:
`+Object.values(t.errors).flat().join(`
`)),R.fire({title:"Error!",text:a,icon:"error",confirmButtonText:"OK",confirmButtonColor:u.palette.error.main})},onFinish:()=>{G(!1)}}))},X=t=>{if(!t)return"default";switch(t.toLowerCase()){case"active":return"success";case"draft":return"warning";case"closed":return"error";default:return"default"}},T=t=>{if(!t)return"Tidak Diketahui";switch(t.toLowerCase()){case"active":return"Aktif";case"draft":return"Draft";case"closed":return"Ditutup";default:return t}},ye=({job:t})=>{var a,o,h,l,s;return e.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(Oe,{sx:{p:3,height:"100%",display:"flex",flexDirection:"column",borderRadius:3,position:"relative","&:hover":{boxShadow:6}},children:[e.jsx(k,{size:"small",sx:{position:"absolute",top:8,right:8},onClick:i=>q(i,t),children:e.jsx(le,{fontSize:"small"})}),e.jsx(n,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx(ie,{src:((a=t.company)==null?void 0:a.logo)||"",alt:(o=t.company)==null?void 0:o.name,sx:{width:80,height:80,bgcolor:i=>`${i.palette.primary.main}20`,color:"primary.main"},children:((l=(h=t.company)==null?void 0:h.name)==null?void 0:l.charAt(0))||e.jsx(ae,{})})}),e.jsx(c,{variant:"h6",align:"center",gutterBottom:!0,noWrap:!0,children:t.title}),e.jsx(c,{variant:"body2",color:"text.secondary",align:"center",sx:{mb:1},children:(s=t.company)==null?void 0:s.name}),e.jsx(n,{sx:{display:"flex",justifyContent:"center",mb:2},children:e.jsx(oe,{label:T(t.status),color:X(t.status),size:"small"})}),e.jsx(Fe,{sx:{my:1}}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(He,{fontSize:"small",color:"action",sx:{mr:1}}),e.jsx(c,{variant:"body2",color:"text.secondary",noWrap:!0,children:t.location})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ve,{fontSize:"small",color:"action",sx:{mr:1}}),e.jsx(c,{variant:"body2",color:"text.secondary",children:v(t.created_at).format("DD MMM YYYY")})]}),e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Ge,{fontSize:"small",color:"action",sx:{mr:1}}),e.jsx(c,{variant:"body2",color:"text.secondary",children:t.salary_min&&t.salary_max?`Rp ${new Intl.NumberFormat("id-ID").format(t.salary_min)} - Rp ${new Intl.NumberFormat("id-ID").format(t.salary_max)}`:t.salary_min?`Rp ${new Intl.NumberFormat("id-ID").format(t.salary_min)}`:"Tidak ditampilkan"})]})]})})},ve=({job:t,size:a=48})=>{var f;const[o,h]=d.useState(!1),l=P(),s=g=>{const D=[l.palette.primary.main,l.palette.secondary.main,l.palette.success.main,l.palette.warning.main,l.palette.info.main],z=g.split("").reduce((I,ke)=>ke.charCodeAt(0)+I,0);return D[z%D.length]},i=()=>{var I;const g=((I=t.company)==null?void 0:I.name)||"Job",D=s(g),z=g.charAt(0).toUpperCase();return e.jsx(n,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",bgcolor:D,color:"white",fontSize:a*.5,fontWeight:700,borderRadius:1},children:z})};return!((f=t.company)!=null&&f.logo)||o?e.jsx(n,{sx:{width:a,height:a,borderRadius:1,overflow:"hidden"},children:i()}):e.jsx(n,{component:"img",src:t.company.logo,alt:t.company.name,onError:()=>h(!0),sx:{width:a,height:a,objectFit:"contain",borderRadius:1,border:"1px solid",borderColor:"divider",p:.5,bgcolor:"white"}})},Y=({icon:t,count:a,label:o,color:h="primary",delay:l=0})=>{const s=P(),f=(g=>g==="grey"?{bgColor:y(s.palette.grey[500],.03),avatarBgColor:y(s.palette.grey[500],.1),avatarColor:s.palette.grey[600]}:{bgColor:y(s.palette[g].main,.03),avatarBgColor:y(s.palette[g].main,.1),avatarColor:s.palette[g].main})(h);return e.jsx(n,{sx:{flex:1,minWidth:"220px",maxWidth:"270px"},children:e.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:l*.1},children:e.jsxs(j,{elevation:0,sx:{p:2,display:"flex",alignItems:"center",gap:2,height:"100%",borderRadius:3,bgcolor:f.bgColor,border:"1px solid",borderColor:"divider"},children:[e.jsx(ie,{sx:{bgcolor:f.avatarBgColor,color:f.avatarColor,width:52,height:52},children:t}),e.jsxs(n,{children:[e.jsx(c,{variant:"h4",component:"div",fontWeight:"bold",children:a}),e.jsx(c,{variant:"body2",color:"text.secondary",children:o})]})]})})})},Ce=()=>{if(!(r!=null&&r.data)||r.data.length===0){alert("Tidak ada data untuk diekspor");return}const t=["ID","Judul","Perusahaan","Lokasi","Status","Tanggal Dibuat","Gaji Minimum","Gaji Maksimum","Jumlah Pelamar"],a=r.data.map(i=>{var f;return[i.id,i.title,((f=i.company)==null?void 0:f.name)||"-",i.location||"-",T(i.status),v(i.created_at).format("DD/MM/YYYY"),i.salary_min?`Rp ${new Intl.NumberFormat("id-ID").format(i.salary_min)}`:"-",i.salary_max?`Rp ${new Intl.NumberFormat("id-ID").format(i.salary_max)}`:"-",i.applications_count||0]}),o=[t.join(","),...a.map(i=>i.join(","))].join(`
`),h=new Blob([o],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(h),s=document.createElement("a");s.setAttribute("href",l),s.setAttribute("download",`lowongan-pekerjaan-${v().format("YYYY-MM-DD")}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},we=()=>{if(!(r!=null&&r.data)||r.data.length===0){alert("Tidak ada data untuk dicetak");return}const t=`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Daftar Lowongan Pekerjaan - ${v().format("DD MMMM YYYY")}</title>
                <style>
                    body {
                        font-family: Arial, sans-serif;
                        margin: 0;
                        padding: 20px;
                    }
                    h1 {
                        text-align: center;
                        margin-bottom: 20px;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    th, td {
                        border: 1px solid #ddd;
                        padding: 8px;
                        text-align: left;
                    }
                    th {
                        background-color: #f2f2f2;
                    }
                    tr:nth-child(even) {
                        background-color: #f9f9f9;
                    }
                    .print-date {
                        text-align: right;
                        margin-bottom: 20px;
                        font-size: 12px;
                    }
                    .status-active {
                        color: green;
                        font-weight: bold;
                    }
                    .status-closed {
                        color: red;
                        font-weight: bold;
                    }
                    .status-draft {
                        color: orange;
                        font-weight: bold;
                    }
                </style>
            </head>
            <body>
                <div class="print-date">Dicetak pada: ${v().format("DD MMMM YYYY, HH:mm:ss")}</div>
                <h1>Daftar Lowongan Pekerjaan</h1>
                <table>
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Judul</th>
                            <th>Perusahaan</th>
                            <th>Lokasi</th>
                            <th>Status</th>
                            <th>Tanggal Dibuat</th>
                            <th>Jumlah Pelamar</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${r.data.map((o,h)=>{var l;return`
                            <tr>
                                <td>${h+1}</td>
                                <td>${o.title}</td>
                                <td>${((l=o.company)==null?void 0:l.name)||"-"}</td>
                                <td>${o.location||"-"}</td>
                                <td class="status-${o.status}">${T(o.status)}</td>
                                <td>${v(o.created_at).format("DD/MM/YYYY")}</td>
                                <td>${o.applications_count||0}</td>
                            </tr>
                        `}).join("")}
                    </tbody>
                </table>
            </body>
            </html>
        `,a=window.open("","_blank");a.document.write(t),a.document.close(),a.focus(),a.onload=function(){a.print()}},je=({anchorEl:t,onClose:a})=>e.jsxs(re,{anchorEl:t,open:!!t,onClose:a,PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.1))",mt:1.5,borderRadius:2,minWidth:180,"& .MuiMenuItem-root":{px:2,py:1.5}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[e.jsxs(M,{onClick:()=>{Ce(),a()},children:[e.jsx(_,{children:e.jsx(Ne,{fontSize:"small"})}),e.jsx($,{children:"Ekspor CSV"})]}),e.jsxs(M,{onClick:()=>{we(),a()},children:[e.jsx(_,{children:e.jsx(Ke,{fontSize:"small"})}),e.jsx($,{children:"Cetak Daftar"})]}),e.jsxs(M,{onClick:()=>{A(),a()},children:[e.jsx(_,{children:e.jsx(Ue,{fontSize:"small"})}),e.jsx($,{children:"Segarkan Data"})]})]});return e.jsxs(Te,{children:[e.jsx(Se,{title:"Daftar Lowongan Pekerjaan"}),e.jsxs(Ie,{maxWidth:"xl",sx:{py:3},children:[e.jsxs(n,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsx(c,{variant:"h4",component:"h1",fontWeight:"bold",children:"Lowongan Pekerjaan"}),e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(B,{variant:"contained",color:"primary",startIcon:e.jsx(Me,{}),onClick:ue,children:"Aksi"}),e.jsx(ee,{href:route("admin.jobs.create"),children:e.jsx(B,{variant:"contained",color:"primary",startIcon:e.jsx(Le,{}),children:"Tambah Lowongan"})})]})]}),e.jsxs(n,{sx:{display:"flex",flexWrap:"wrap",gap:2,mb:3},children:[e.jsx(Y,{icon:e.jsx(ae,{}),count:me,label:"Total Lowongan"}),e.jsx(Y,{icon:e.jsx(Ye,{}),count:pe,label:"Lowongan Aktif",color:"success",delay:1}),e.jsx(Y,{icon:e.jsx(ze,{}),count:xe,label:"Lowongan Ditutup",color:"error",delay:2})]}),e.jsxs(j,{elevation:0,sx:{borderRadius:"1rem",overflow:"hidden",border:"1px solid",borderColor:"divider",mb:3},children:[e.jsx(n,{sx:{borderBottom:1,borderColor:"divider"},children:e.jsxs(Re,{value:L,onChange:he,"aria-label":"status lowongan tabs",sx:{".MuiTabs-indicator":{height:3,borderTopLeftRadius:3,borderTopRightRadius:3},".MuiTab-root":{textTransform:"none",fontWeight:600,px:3,py:1.5}},children:[e.jsx(E,{label:"Semua Lowongan"}),e.jsx(E,{label:"Aktif"}),e.jsx(E,{label:"Ditutup"})]})}),e.jsx(n,{sx:{p:2,borderBottom:`1px solid ${y(u.palette.divider,.1)}`},children:e.jsxs(n,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[e.jsx(n,{sx:{flex:"1 1 260px"},children:e.jsx(Pe,{fullWidth:!0,placeholder:"Cari lowongan berdasarkan judul, perusahaan, atau lokasi...",value:p,onChange:t=>O(t.target.value),InputProps:{startAdornment:e.jsx(Be,{position:"start",children:e.jsx(Ae,{fontSize:"small"})}),sx:{borderRadius:2,bgcolor:y(u.palette.common.black,.02)}},variant:"outlined",size:"small"})}),e.jsx(n,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(F,{title:"Reset Semua Filter",children:e.jsx("span",{children:e.jsx(k,{color:"primary",onClick:A,disabled:!p&&L===0,size:"small",sx:{border:`1px solid ${y(u.palette.primary.main,.2)}`,borderRadius:2},children:e.jsx(ne,{fontSize:"small"})})})})})]})}),e.jsxs(n,{sx:{px:3,py:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(n,{children:e.jsxs(c,{variant:"body2",color:"text.secondary",children:[r.total," ",(r.total===1,"lowongan")," ditemukan",p||x?" dengan filter saat ini":""]})}),(p||L>0)&&e.jsx(B,{variant:"text",size:"small",startIcon:e.jsx(ne,{fontSize:"small"}),onClick:A,children:"Hapus Filter"})]}),de==="list"?e.jsx(n,{sx:{px:2,pb:2},children:e.jsx(j,{elevation:0,sx:{borderRadius:2,border:`1px solid ${y(u.palette.divider,.1)}`,overflow:"hidden"},children:e.jsx(_e,{children:e.jsxs($e,{sx:{minWidth:650},children:[e.jsx(Ee,{sx:{bgcolor:y(u.palette.primary.main,.02)},children:e.jsxs(W,{children:[e.jsx(m,{children:"Lowongan"}),e.jsx(m,{children:"Perusahaan"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Tanggal Dibuat"}),e.jsx(m,{align:"center",children:"Pelamar"}),e.jsx(m,{children:"Aksi"})]})}),e.jsx(We,{children:r.data.length>0?r.data.map(t=>e.jsxs(W,{hover:!0,children:[e.jsx(m,{children:e.jsxs(n,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ve,{job:t,size:40}),e.jsxs(n,{sx:{ml:2},children:[e.jsx(c,{variant:"body1",fontWeight:"medium",children:t.title}),e.jsx(c,{variant:"body2",color:"text.secondary",children:t.location})]})]})}),e.jsx(m,{children:t.company?t.company.name:"-"}),e.jsx(m,{children:e.jsx(oe,{label:T(t.status),color:X(t.status),size:"small"})}),e.jsx(m,{children:v(t.created_at).format("DD MMM YYYY")}),e.jsx(m,{align:"center",children:t.applications_count||0}),e.jsx(m,{children:e.jsxs(n,{sx:{display:"flex",gap:1},children:[e.jsx(ee,{href:route("admin.jobs.edit",t.id),children:e.jsx(k,{size:"small",color:"primary",children:e.jsx(F,{title:"Edit",children:e.jsx(Je,{fontSize:"small"})})})}),e.jsx(k,{size:"small",color:"error",onClick:()=>U(t),children:e.jsx(F,{title:"Hapus",children:e.jsx(se,{fontSize:"small"})})}),e.jsx(k,{size:"small",onClick:a=>q(a,t),children:e.jsx(le,{fontSize:"small"})})]})})]},t.id)):e.jsx(W,{children:e.jsx(m,{colSpan:7,align:"center",sx:{py:3},children:e.jsx(c,{variant:"body2",color:"text.secondary",children:"Tidak ada data lowongan pekerjaan"})})})})]})})})}):e.jsx(n,{sx:{p:2},children:e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:3,mb:3},children:r.data.length>0?r.data.map(t=>e.jsx(n,{sx:{width:{xs:"100%",sm:"calc(50% - 12px)",md:"calc(33.333% - 16px)",lg:"calc(25% - 18px)"}},children:e.jsx(ye,{job:t})},t.id)):e.jsx(n,{sx:{width:"100%"},children:e.jsx(j,{sx:{p:3,textAlign:"center",borderRadius:3},children:e.jsx(c,{variant:"body2",color:"text.secondary",children:"Tidak ada data lowongan pekerjaan"})})})})})]}),((Z=r==null?void 0:r.meta)==null?void 0:Z.last_page)>1&&e.jsx(j,{elevation:0,sx:{borderRadius:"1rem",border:"1px solid",borderColor:"divider",boxShadow:"none",p:2,mb:4},children:e.jsx(De,{currentPage:r.meta.current_page,totalPages:r.meta.last_page,totalItems:r.meta.total,perPage:r.meta.per_page,onPageChange:t=>{const a={...route().params,page:t};p&&(a.search=p),categoryFilter&&(a.category=categoryFilter),x&&(a.status=x),C.get(route("admin.jobs.index",a),{},{preserveState:!0,replace:!0,only:["jobs"]})},onPerPageChange:t=>{const a={...route().params,per_page:t,page:1};p&&(a.search=p),categoryFilter&&(a.category=categoryFilter),x&&(a.status=x),C.get(route("admin.jobs.index",a),{},{preserveState:!0,replace:!0,only:["jobs"]})},showFirst:!0,showLast:!0,rounded:"large"})})]}),e.jsx(re,{anchorEl:H,open:!!H,onClose:Q,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:e.jsxs(M,{onClick:()=>{Q(),b&&U(b)},sx:{color:"error.main"},children:[e.jsx(se,{fontSize:"small",sx:{mr:1}}),"Hapus Lowongan"]})}),e.jsx(je,{anchorEl:ce,onClose:fe})]})};export{Ht as default};
