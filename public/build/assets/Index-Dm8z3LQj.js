import{j as e,q as xe,r as d,f as b,a as ue,b as s,m as H,J as B,A as fe}from"./app-DbtvrzCH.js";import"./moment-C5S46NFB.js";import{S as V}from"./sweetalert2.esm.all-DV3w3JmD.js";import{T as ge}from"./Table-B5QHKXcj.js";import{B as P,I as v,M as je}from"./Button-CgCKgwRd.js";import"./Modal-B-OjsfG3.js";import{A as be}from"./Alert-BWXyQfZl.js";import{L as ve}from"./Layout-nP23ILEi.js";import{P as ye}from"./Pagination-D3ETEnxi.js";import{c as Ce,u as G,B as o,T as g,P as L}from"./Button-B_2tu0cn.js";import{A as ee,C as D}from"./Slide-DsAvN5qg.js";import{B as W,T as y,S as Se,M as k,a as R,b as _}from"./Work-bK6ZZ-Qp.js";import{A as ke}from"./Add-DoOXNSNv.js";import{C as E}from"./CheckCircleOutline-D6CUxKxL.js";import{D as F}from"./DoDisturbOn-RAd5iuyo.js";import{M as Te}from"./MoreVert-DyEsPTVO.js";import{T as Ie,a as O}from"./Tabs-DDppPwJC.js";import{T as X}from"./TextField-BKjSZQPY.js";import{I as Y}from"./InputAdornment-Vh23wNde.js";import{F as Z}from"./FilterList-D0xY2zDR.js";import{C as we}from"./Card-DBrS13VS.js";import{C as ze}from"./CloudDownload-DPHjtUjP.js";import{P as Ae}from"./Print-K67R6tf8.js";import{R as Me}from"./Sidebar-sw6YawgY.js";import{V as Be}from"./Visibility-7zZFC74a.js";import{E as Pe}from"./Edit-LT1RMSQh.js";import{D as Le}from"./Delete-DKhiqqSP.js";import{O as De}from"./OpenInNew-D8-FU0dq.js";import{L as We}from"./Language-BFV8emV3.js";import"./TableRow-DitY7KzI.js";import"./Checkbox-D9hSuJOi.js";import"./SwitchBase-BHRWgqGq.js";import"./TablePagination-DtYWInOg.js";import"./KeyboardArrowRight-B784So0V.js";import"./LastPage-ByPDXHdv.js";import"./Select-DuuFGO1T.js";import"./DialogContent-CpDcnQgJ.js";import"./DialogTitle-CnVKeRzh.js";import"./Close-BbHhCS19.js";import"./DialogContentText-BbIC-bWf.js";import"./Alert-D22fyny9.js";import"./Close-Dpj-0MLQ.js";import"./AlertTitle-CTfZdqfc.js";import"./AccessTime-as3EkDL5.js";import"./ArrowForward-jR7HuMfl.js";import"./Error-D1IMUwky.js";import"./Warning-CYk4HSbS.js";import"./Info-j9m1PK-Q.js";import"./CheckCircle-nvk-SVVX.js";import"./LinearProgress-Cp3Ye6up.js";import"./Footer-BBk2Lp_N.js";import"./Container-CHMV_DAY.js";import"./index-BJHsQb-H.js";import"./KeyboardArrowLeft-ISc4gDFH.js";import"./ButtonGroup-CCy93Gk6.js";import"./Stack-CsubfPvX.js";import"./InputLabel-DUQX8vmT.js";import"./id-DNGKkZzB.js";import"./ChevronRight-Bjx9uoMx.js";import"./Person-C1OGobf6.js";import"./People-KxvvNdCJ.js";import"./Event-JhFTkm8A.js";const Re=Ce(e.jsx("path",{d:"M4 10h3v7H4zm6.5 0h3v7h-3zM2 19h20v3H2zm15-9h3v7h-3zm-5-9L2 6v2h20V6z"})),_e=({company:r,size:l=48})=>{const[m,i]=d.useState(!1),n=G(),p=u=>{if(!u)return n.palette.primary.main;const h=[n.palette.primary.main,n.palette.secondary.main,n.palette.success.main,n.palette.warning.main,n.palette.info.main],j=u.split("").reduce((w,C)=>C.charCodeAt(0)+w,0);return h[j%h.length]},T=()=>{var j;const u=p(r.name),h=((j=r.name)==null?void 0:j.charAt(0).toUpperCase())||"C";return e.jsx(o,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",bgcolor:u,color:"white",fontSize:l*.5,fontWeight:700,borderRadius:1},children:h})};return!r.logo||m?e.jsx(o,{sx:{width:l,height:l,borderRadius:1,overflow:"hidden"},children:T()}):e.jsx(o,{component:"img",src:r.logo,alt:r.name,onError:()=>i(!0),sx:{width:l,height:l,objectFit:"contain",borderRadius:1,border:"1px solid",borderColor:"divider",p:.5,bgcolor:"white"}})},Ee=(r,l)=>{V.fire({title:"Hapus Perusahaan",html:`
            <p>Apakah Anda yakin ingin menghapus ${r==null?void 0:r.name}?</p>
            <p style="color: #666; font-size: 0.9em; margin-top: 8px;">
                Tindakan ini tidak dapat dibatalkan. Semua data terkait perusahaan ini akan dihapus secara permanen.
            </p>
        `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#f44336",cancelButtonColor:"#9e9e9e",confirmButtonText:"Hapus",cancelButtonText:"Batal"}).then(m=>{m.isConfirmed&&l()})},$=({icon:r,count:l,label:m,color:i="primary",delay:n=0})=>{const p=G(),u=(h=>h==="grey"?{bgColor:s(p.palette.grey[500],.03),avatarBgColor:s(p.palette.grey[500],.1),avatarColor:p.palette.grey[600]}:{bgColor:s(p.palette[h].main,.03),avatarBgColor:s(p.palette[h].main,.1),avatarColor:p.palette[h].main})(i);return e.jsx(o,{sx:{flex:1,minWidth:"220px",maxWidth:"270px"},children:e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:n},children:e.jsxs(we,{elevation:0,sx:{display:"flex",alignItems:"center",p:2,borderRadius:2,border:`1px solid ${s(p.palette.divider,.1)}`,boxShadow:`0 1px 5px ${s(p.palette.common.black,.05)}`,bgcolor:u.bgColor},children:[e.jsx(ee,{sx:{bgcolor:u.avatarBgColor,color:u.avatarColor,width:56,height:56,mr:2},children:r}),e.jsxs(o,{children:[e.jsx(g,{variant:"h4",fontWeight:700,gutterBottom:!0,children:l}),e.jsx(g,{variant:"body2",color:"text.secondary",children:m})]})]})})})},Fe=({anchorEl:r,onClose:l})=>e.jsxs(je,{anchorEl:r,open:!!r,onClose:l,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.1))",mt:1.5,borderRadius:2,minWidth:180,"& .MuiMenuItem-root":{px:2,py:1.5}}},children:[e.jsxs(k,{onClick:()=>{exportToCSV(),l()},children:[e.jsx(R,{children:e.jsx(ze,{fontSize:"small"})}),e.jsx(_,{children:"Ekspor CSV"})]}),e.jsxs(k,{onClick:()=>{printCompanyList(),l()},children:[e.jsx(R,{children:e.jsx(Ae,{fontSize:"small"})}),e.jsx(_,{children:"Cetak Daftar"})]}),e.jsxs(k,{onClick:()=>{resetFilters(),l()},children:[e.jsx(R,{children:e.jsx(Me,{fontSize:"small"})}),e.jsx(_,{children:"Segarkan Data"})]})]}),Nt=({companies:r={data:[]},filters:l={industries:[]}})=>{var U,Q;const{flash:m}=xe().props,i=G(),[n,p]=d.useState(""),[T,u]=d.useState(!1),[h,j]=d.useState(null),[w,C]=d.useState(""),[te,z]=d.useState("success"),[re,S]=d.useState(!1),[c,K]=d.useState(""),[x,I]=d.useState(""),[A,J]=d.useState(0),[ae,q]=d.useState(null),ie=d.useMemo(()=>{var t;return(r==null?void 0:r.total)||((t=r==null?void 0:r.data)==null?void 0:t.length)||0},[r]),se=d.useMemo(()=>{var t,a;return((a=(t=r==null?void 0:r.data)==null?void 0:t.filter(f=>f.is_active))==null?void 0:a.length)||0},[r]),oe=d.useMemo(()=>{var t,a;return((a=(t=r==null?void 0:r.data)==null?void 0:t.filter(f=>!f.is_active))==null?void 0:a.length)||0},[r]);d.useEffect(()=>{if(m!=null&&m.message){C(m.message),z(m.type||"success"),S(!0);const t=setTimeout(()=>{S(!1)},5e3);return()=>clearTimeout(t)}},[m]);const ne=(t,a)=>{J(a),a===0?I(""):a===1?I("active"):a===2&&I("inactive")},le=t=>{q(t.currentTarget)},de=()=>{q(null)},ce=[{field:"logo",header:"",width:"70px",render:(t,a)=>e.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(_e,{company:a,size:44})})},{field:"name",header:"Nama Perusahaan",sortable:!0,render:(t,a)=>e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsx(g,{variant:"body1",fontWeight:600,children:t}),e.jsx(g,{variant:"caption",color:"text.secondary",children:a.address?a.address.split(",")[0]:"Lokasi tidak tersedia"})]})},{field:"industry",header:"Industri",sortable:!0,render:t=>e.jsx(D,{label:t||"Tidak tersedia",size:"small",color:t?"primary":"default",variant:t?"filled":"outlined",sx:{bgcolor:t?s(i.palette.primary.main,.1):"transparent",color:t?i.palette.primary.main:i.palette.text.disabled,fontWeight:500,"& .MuiChip-label":{px:1.5}}})},{field:"is_active",header:"Status",sortable:!0,render:t=>e.jsx(o,{sx:{display:"flex",alignItems:"center",gap:.5},children:t?e.jsx(D,{icon:e.jsx(E,{fontSize:"small"}),label:"Aktif",color:"success",size:"small",variant:"filled",sx:{bgcolor:s(i.palette.success.main,.1),color:i.palette.success.dark,fontWeight:500,".MuiChip-icon":{fontSize:"1rem",color:"inherit"}}}):e.jsx(D,{icon:e.jsx(F,{fontSize:"small"}),label:"Tidak Aktif",color:"default",size:"small",variant:"outlined",sx:{color:i.palette.text.disabled,fontWeight:500,".MuiChip-icon":{fontSize:"1rem",color:"inherit"}}})})},{field:"website",header:"Website",render:t=>t?e.jsx(P,{component:"a",href:t.startsWith("http")?t:`https://${t}`,target:"_blank",rel:"noopener noreferrer",variant:"text",color:"primary",startIcon:e.jsx(We,{fontSize:"small"}),endIcon:e.jsx(De,{fontSize:"small"}),size:"small",sx:{textTransform:"none",fontWeight:400,fontSize:"0.875rem"},children:t.replace(/^https?:\/\//,"")}):e.jsx(g,{variant:"body2",color:"text.disabled",children:"Tidak tersedia"})},{field:"created_at",header:"Tanggal Dibuat",sortable:!0,render:t=>{const a=new Date(t).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"});return e.jsx(g,{variant:"body2",color:"text.secondary",children:a})}}],M=d.useMemo(()=>{if(!(r!=null&&r.data)||!Array.isArray(r.data))return[];let t=[...r.data];if(n){const a=n.toLowerCase();t=t.filter(f=>f.name&&f.name.toLowerCase().includes(a)||f.industry&&f.industry.toLowerCase().includes(a)||f.address&&f.address.toLowerCase().includes(a))}return c&&(t=t.filter(a=>a.industry===c)),x==="active"?t=t.filter(a=>a.is_active):x==="inactive"&&(t=t.filter(a=>!a.is_active)),t},[r==null?void 0:r.data,n,c,x]);d.useEffect(()=>{if(r!=null&&r.data&&(n||c||x)){const t={...route().params};n?t.search=n:delete t.search,c?t.industry=c:delete t.industry,x?t.status=x:delete t.status,t.page=1,b.get(route("admin.companies.index",t),{},{preserveState:!0,replace:!0,only:["companies"]})}},[n,c,x]);const pe=()=>{h&&(u(!0),b.delete(route("admin.companies.destroy",h.id),{onSuccess:t=>{j(null);const a=t.props.flash&&t.props.flash.message?t.props.flash.message:"Perusahaan berhasil dihapus";V.fire({title:"Berhasil!",text:a,icon:"success",confirmButtonText:"OK",confirmButtonColor:i.palette.primary.main}),b.reload({only:["companies"]})},onError:t=>{console.error("Error deleting company:",t);let a="Gagal menghapus perusahaan: Terjadi kesalahan";t.message?a=t.message:t.errors&&Object.keys(t.errors).length>0&&(a=`Gagal menghapus perusahaan:
`+Object.values(t.errors).flat().join(`
`)),V.fire({title:"Error!",text:a,icon:"error",confirmButtonText:"OK",confirmButtonColor:i.palette.error.main})},onFinish:()=>u(!1)}))},me=t=>{b.post(route("admin.companies.toggle-active",t.id),{onSuccess:()=>{C(`Status perusahaan ${t.is_active?"dinonaktifkan":"diaktifkan"} berhasil.`),z("success"),S(!0)},onError:a=>{C("Gagal mengupdate status perusahaan: "+Object.values(a).flat().join(" ")),z("error"),S(!0)}})},he=t=>e.jsxs(o,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[e.jsx(y,{title:"Lihat Detail",children:e.jsx(v,{size:"small",component:B,href:route("admin.companies.show",t.id),sx:{color:i.palette.info.main,bgcolor:s(i.palette.info.main,.1),"&:hover":{bgcolor:s(i.palette.info.main,.2)}},children:e.jsx(Be,{fontSize:"small"})})}),e.jsx(y,{title:"Edit",children:e.jsx(v,{size:"small",component:B,href:route("admin.companies.edit",t.id),sx:{color:i.palette.primary.main,bgcolor:s(i.palette.primary.main,.1),"&:hover":{bgcolor:s(i.palette.primary.main,.2)}},children:e.jsx(Pe,{fontSize:"small"})})}),e.jsx(y,{title:t.is_active?"Nonaktifkan":"Aktifkan",children:e.jsx(v,{size:"small",onClick:()=>me(t),sx:{color:t.is_active?i.palette.warning.main:i.palette.success.main,bgcolor:t.is_active?s(i.palette.warning.main,.1):s(i.palette.success.main,.1),"&:hover":{bgcolor:t.is_active?s(i.palette.warning.main,.2):s(i.palette.success.main,.2)}},children:t.is_active?e.jsx(F,{fontSize:"small"}):e.jsx(E,{fontSize:"small"})})}),e.jsx(y,{title:"Hapus",children:e.jsx(v,{size:"small",onClick:()=>{j(t),Ee(t,pe)},sx:{color:i.palette.error.main,bgcolor:s(i.palette.error.main,.1),"&:hover":{bgcolor:s(i.palette.error.main,.2)}},children:e.jsx(Le,{fontSize:"small"})})})]}),N=()=>{p(""),K(""),I(""),J(0),b.get(route("admin.companies.index"),{},{preserveState:!1,only:["companies"]})};return e.jsxs(ve,{children:[e.jsx(ue,{title:"Perusahaan"}),e.jsxs(o,{sx:{mb:4,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(ee,{sx:{width:56,height:56,bgcolor:s(i.palette.primary.main,.1),color:i.palette.primary.main},children:e.jsx(W,{fontSize:"large"})}),e.jsxs(o,{children:[e.jsx(g,{variant:"h4",component:"h1",fontWeight:700,children:"Perusahaan"}),e.jsx(g,{variant:"body2",color:"text.secondary",children:"Kelola perusahaan dan profil mereka"})]})]}),e.jsx(H.div,{whileHover:{scale:1.03},whileTap:{scale:.98},children:e.jsx(P,{variant:"contained",startIcon:e.jsx(ke,{}),component:B,href:route("admin.companies.create"),size:"large",sx:{px:3},children:"Tambah Perusahaan"})})]}),e.jsx(fe,{children:re&&e.jsx(H.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsx(be,{severity:te,onClose:()=>S(!1),sx:{mb:3},children:w})})}),e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:3,mb:3},children:[e.jsx($,{icon:e.jsx(W,{}),count:ie,label:"Total Perusahaan",color:"primary",delay:0}),e.jsx($,{icon:e.jsx(E,{}),count:se,label:"Perusahaan Aktif",color:"success",delay:.1}),e.jsx($,{icon:e.jsx(F,{}),count:oe,label:"Perusahaan Tidak Aktif",color:"grey",delay:.2})]}),e.jsxs(L,{elevation:0,sx:{borderRadius:3,boxShadow:"0 2px 10px rgba(0,0,0,0.04)",border:`1px solid ${s(i.palette.divider,.1)}`,overflow:"hidden",mb:4},children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",p:2,pl:3,borderBottom:`1px solid ${s(i.palette.divider,.1)}`},children:[e.jsxs(o,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(W,{color:"primary"}),e.jsx(g,{variant:"h6",fontWeight:600,children:"Direktori Perusahaan"})]}),e.jsxs(o,{children:[e.jsx(y,{title:"Lihat Lebih Banyak",children:e.jsx(v,{onClick:le,children:e.jsx(Te,{})})}),e.jsx(Fe,{anchorEl:ae,onClose:de})]})]}),e.jsx(o,{sx:{borderBottom:1,borderColor:"divider",px:2},children:e.jsxs(Ie,{value:A,onChange:ne,"aria-label":"status perusahaan tabs",sx:{".MuiTabs-indicator":{height:3,borderTopLeftRadius:3,borderTopRightRadius:3},".MuiTab-root":{textTransform:"none",fontWeight:600,px:3,py:1.5}},children:[e.jsx(O,{label:"Semua Perusahaan"}),e.jsx(O,{label:"Aktif"}),e.jsx(O,{label:"Tidak Aktif"})]})}),e.jsx(o,{sx:{p:2,borderBottom:`1px solid ${s(i.palette.divider,.1)}`},children:e.jsxs(o,{sx:{display:"flex",flexWrap:"wrap",gap:2,alignItems:"center"},children:[e.jsx(o,{sx:{flex:"1 1 260px"},children:e.jsx(X,{fullWidth:!0,placeholder:"Cari perusahaan berdasarkan nama atau industri...",value:n,onChange:t=>p(t.target.value),InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(Se,{fontSize:"small"})}),sx:{borderRadius:2,bgcolor:s(i.palette.common.black,.02)}},variant:"outlined",size:"small"})}),e.jsx(o,{sx:{flex:"1 1 220px"},children:e.jsxs(X,{select:!0,fullWidth:!0,size:"small",label:"Industri",value:c,onChange:t=>K(t.target.value),InputProps:{startAdornment:e.jsx(Y,{position:"start",children:e.jsx(Re,{fontSize:"small",color:"action"})}),sx:{borderRadius:2}},children:[e.jsx(k,{value:"",children:"Semua Industri"}),(U=l==null?void 0:l.industries)==null?void 0:U.map(t=>e.jsx(k,{value:t,children:t},t))]})}),e.jsx(o,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(y,{title:"Reset Semua Filter",children:e.jsx("span",{children:e.jsx(v,{color:"primary",onClick:N,disabled:!n&&!c&&A===0,size:"small",sx:{border:`1px solid ${s(i.palette.primary.main,.2)}`,borderRadius:2},children:e.jsx(Z,{fontSize:"small"})})})})})]})}),e.jsxs(o,{sx:{px:3,py:2,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(o,{children:e.jsxs(g,{variant:"body2",color:"text.secondary",children:[M.length," ",(M.length===1,"perusahaan")," ditemukan",n||c||x?" dengan filter saat ini":""]})}),(n||c||A>0)&&e.jsx(P,{variant:"text",size:"small",startIcon:e.jsx(Z,{fontSize:"small"}),onClick:N,children:"Hapus Filter"})]}),e.jsx(o,{sx:{px:2,pb:2},children:e.jsx(L,{elevation:0,sx:{borderRadius:2,border:`1px solid ${s(i.palette.divider,.1)}`,overflow:"hidden"},children:e.jsx(ge,{data:M,columns:ce,actions:he,emptyMessage:"Tidak ada perusahaan ditemukan dengan filter saat ini.",sx:{".MuiTableHead-root":{bgcolor:s(i.palette.primary.main,.02)},".MuiTableCell-head":{fontWeight:600},".MuiTableRow-root:hover":{bgcolor:s(i.palette.primary.main,.03)}},loading:T})})})]}),((Q=r==null?void 0:r.meta)==null?void 0:Q.last_page)>1&&e.jsx(L,{elevation:0,sx:{borderRadius:"1rem",border:"1px solid",borderColor:"divider",boxShadow:"none",p:2,mb:4},children:e.jsx(ye,{currentPage:r.meta.current_page,totalPages:r.meta.last_page,totalItems:r.meta.total,perPage:r.meta.per_page,onPageChange:t=>{const a={...route().params,page:t};n&&(a.search=n),c&&(a.industry=c),x&&(a.status=x),b.get(route("admin.companies.index",a),{},{preserveState:!0,replace:!0,only:["companies"]})},onPerPageChange:t=>{const a={...route().params,per_page:t,page:1};n&&(a.search=n),c&&(a.industry=c),x&&(a.status=x),b.get(route("admin.companies.index",a),{},{preserveState:!0,replace:!0,only:["companies"]})},showFirst:!0,showLast:!0,rounded:"large"})})]})};export{Nt as default};
