import{j as r,r as h,A as Dr,m as ar,b as c,c as or}from"./app-DbtvrzCH.js";import{c as Ur,u as zr,B as p,T as x,C as Sr,a as nr,P as N}from"./Button-B_2tu0cn.js";import{L as Er}from"./LinearProgress-Cp3Ye6up.js";import{C as Wr}from"./CloudUpload-vL1lrGKt.js";import{U as Br}from"./Upload-B7qw_qx9.js";import{A as Lr}from"./Alert-D22fyny9.js";import{E as Mr}from"./Error-D1IMUwky.js";import{T as B}from"./Work-bK6ZZ-Qp.js";import{C as V}from"./Check-DS_0GrJd.js";import{I as ir}from"./Button-CgCKgwRd.js";import{D as Y}from"./Delete-DKhiqqSP.js";import{P as Ar}from"./PictureAsPdf-D2_5a5_Z.js";import{D as lr}from"./Description-Z4oGvRZp.js";import{F as $r}from"./InsertDriveFile-DWL1oYxZ.js";const Or=Ur(r.jsx("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2M8.5 13.5l2.5 3.01L14.5 12l4.5 6H5z"})),q=n=>n!=null&&n.startsWith("image/")?r.jsx(Or,{color:"info"}):n==="application/pdf"?r.jsx(Ar,{color:"error"}):n!=null&&n.includes("word")||n!=null&&n.includes("document")?r.jsx(lr,{color:"primary"}):n!=null&&n.includes("csv")||n!=null&&n.includes("excel")||n!=null&&n.includes("spreadsheet")?r.jsx(lr,{color:"success"}):r.jsx($r,{color:"action"}),cr=n=>{if(n===0)return"0 Bytes";const g=1024,b=["Bytes","KB","MB","GB","TB"],F=Math.floor(Math.log(n)/Math.log(g));return parseFloat((n/Math.pow(g,F)).toFixed(2))+" "+b[F]},dr=n=>{const g={resume:"/api/candidate-profiles/upload-resume",companyLogo:"/api/companies/upload-logo",avatar:"/api/users/upload-avatar",jobApplication:"/api/job-applications/upload-resume",formResponse:"/api/form-responses/upload-attachment",default:"/api/uploads"};return g[n]||g.default},se=({name:n,label:g,accept:b=".pdf,.doc,.docx",maxSize:F=5,value:k,onChange:j,error:L,helperText:J,className:pr,borderRadius:ur="medium",dragAndDrop:C=!0,variant:mr="outlined",multiple:m=!1,showProgress:xr=!0,showPreview:fr=!0,previewType:hr="inline",uploadType:Q="default",entity:D={},onUploadComplete:U,autoUpload:M=!1,required:gr=!1,showUploadButton:jr=!1,disabled:i=!1,...yr})=>{const s=zr(),[I,A]=h.useState(!1),[y,z]=h.useState(!1),[X,S]=h.useState(0),[o,v]=h.useState(k||(m?[]:null)),[$,P]=h.useState(""),[vr,w]=h.useState(!1),[Hr,O]=h.useState(null),E=h.useRef(null);h.useEffect(()=>{k&&v(k)},[k]);const W=()=>{switch(ur){case"small":return"8px";case"medium":return"16px";case"large":return"24px";default:return"16px"}},br=()=>{const t={borderRadius:W(),transition:"all 0.2s ease-in-out",cursor:i?"not-allowed":"pointer",position:"relative",padding:s.spacing(3),textAlign:"center",opacity:i?.7:1};switch(mr){case"filled":return{...t,backgroundColor:I?c(s.palette.primary.main,.08):s.palette.grey[50],border:"2px dashed transparent","&:hover":i?{}:{backgroundColor:c(s.palette.primary.main,.04)}};case"glass":return{...t,backdropFilter:"blur(8px)",backgroundColor:I?c(s.palette.primary.main,.08):c(s.palette.background.paper,.7),border:`2px dashed ${I?s.palette.primary.main:c(s.palette.divider,.5)}`,"&:hover":i?{}:{backgroundColor:c(s.palette.primary.main,.04),borderColor:s.palette.primary.light}};case"outlined":default:return{...t,backgroundColor:I?c(s.palette.primary.main,.05):"transparent",border:`2px dashed ${I?s.palette.primary.main:s.palette.divider}`,"&:hover":i?{}:{borderColor:s.palette.primary.main,backgroundColor:c(s.palette.primary.main,.04)}}}},Fr=e=>{i||(e.preventDefault(),e.stopPropagation(),A(!0))},Ir=e=>{i||(e.preventDefault(),e.stopPropagation(),A(!1))},Pr=e=>{i||(e.preventDefault(),e.stopPropagation())},Z=e=>{const t=e.type;return b.split(",").map(l=>l.trim()).some(l=>l.startsWith(".")?e.name.toLowerCase().endsWith(l.toLowerCase()):t.match(l))?e.size>F*1024*1024?`File size must be less than ${F}MB`:null:`File type must be ${b}`},wr=e=>{if(!i)if(m){const t=Array.from(e.target.files);_(t)}else{const t=e.target.files[0];t&&(T(t),M&&H(t))}},Rr=e=>{if(!i&&(e.preventDefault(),e.stopPropagation(),A(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0))if(m){const t=Array.from(e.dataTransfer.files);_(t),M&&rr(t)}else{const t=e.dataTransfer.files[0];T(t),M&&H(t)}},_=e=>{if(!e.length)return;const t=e.map(d=>Z(d));if(t.some(d=>d!==null)){const d=t.find(a=>a!==null);P(d);return}P("");const l=e.map(d=>({name:d.name,size:d.size,type:d.type,url:URL.createObjectURL(d),file:d}));v(l),j&&j(e)},T=e=>{if(!e)return;const t=Z(e);if(t){P(t);return}P("");const u={name:e.name,size:e.size,type:e.type,url:URL.createObjectURL(e),file:e};v(u),j&&j(e)},H=async e=>{var l,d;if(!e)return;const t=new FormData;t.append("file",e),Object.keys(D).forEach(a=>{t.append(a,D[a])});const u=dr(Q);try{z(!0),S(0),w(!1);const a=await or.post(u,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:f=>{const R=Math.round(f.loaded*100/f.total);S(R)}});w(!0),O(a.data),U&&U(a.data),a.data&&a.data.filePath&&v(f=>({...f,url:a.data.filePath,uploaded:!0,id:a.data.id}))}catch(a){console.error("Upload error:",a),P(((d=(l=a.response)==null?void 0:l.data)==null?void 0:d.message)||"Error uploading file")}finally{z(!1)}},rr=async e=>{var l,d;if(!e||!e.length)return;const t=new FormData;e.forEach((a,f)=>{t.append(`files[${f}]`,a)}),Object.keys(D).forEach(a=>{t.append(a,D[a])});const u=dr(Q);try{z(!0),S(0),w(!1);const a=await or.post(u,t,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:f=>{const R=Math.round(f.loaded*100/f.total);S(R)}});if(w(!0),O(a.data),U&&U(a.data),a.data&&a.data.files){const f=o.map((R,er)=>{var tr,sr;return{...R,url:((tr=a.data.files[er])==null?void 0:tr.filePath)||R.url,uploaded:!0,id:(sr=a.data.files[er])==null?void 0:sr.id}});v(f)}}catch(a){console.error("Upload error:",a),P(((d=(l=a.response)==null?void 0:l.data)==null?void 0:d.message)||"Error uploading files")}finally{z(!1)}},G=(e,t)=>{if(!i)if(t.stopPropagation(),m&&Array.isArray(o)){const u=o.filter(l=>l!==e);if(v(u),j){const l=u.map(d=>d.file);j(l)}}else v(null),w(!1),O(null),E.current&&(E.current.value=""),j&&j(null)},Cr=()=>{if(!(i||y))if(m&&Array.isArray(o)&&o.length>0){const e=o.map(t=>t.file);rr(e)}else!m&&o&&H(o.file)},kr=()=>{var e;return m&&Array.isArray(o)?o.length?hr==="list"?r.jsx(N,{elevation:0,sx:{mt:2,p:1,borderRadius:W(),border:`1px solid ${s.palette.divider}`},children:o.map((t,u)=>r.jsxs(p,{sx:{p:1,mb:u<o.length-1?1:0,borderRadius:"8px",display:"flex",alignItems:"center","&:hover":{bgcolor:c(s.palette.primary.main,.04)}},children:[r.jsx(p,{sx:{p:1,borderRadius:"8px",bgcolor:c(s.palette.grey[500],.1),mr:2},children:q(t.type)}),r.jsxs(p,{sx:{flex:1,minWidth:0},children:[r.jsx(x,{variant:"body2",sx:{fontWeight:500,mb:.5},noWrap:!0,children:t.name}),r.jsx(x,{variant:"caption",color:"text.secondary",children:cr(t.size)})]}),t.uploaded&&r.jsx(p,{sx:{mx:1},children:r.jsx(B,{title:"Uploaded successfully",children:r.jsx(V,{color:"success"})})}),r.jsx(B,{title:"Remove file",children:r.jsx(ir,{size:"small",color:"error",onClick:l=>G(t,l),sx:{ml:1},disabled:i||y,children:r.jsx(Y,{fontSize:"small"})})})]},u))}):r.jsx(p,{sx:{mt:2,display:"flex",flexWrap:"wrap",gap:1},children:o.map((t,u)=>r.jsxs(N,{elevation:1,sx:{p:1,borderRadius:"8px",display:"inline-flex",alignItems:"center",bgcolor:t.uploaded?c(s.palette.success.main,.05):c(s.palette.primary.main,.05),border:`1px solid ${t.uploaded?c(s.palette.success.main,.2):c(s.palette.primary.main,.1)}`},children:[q(t.type),r.jsx(x,{variant:"body2",sx:{fontWeight:500,mx:1},noWrap:!0,children:t.name}),t.uploaded&&r.jsx(p,{sx:{mr:.5},children:r.jsx(B,{title:"Uploaded successfully",children:r.jsx(V,{color:"success"})})}),r.jsx(ir,{size:"small",onClick:l=>G(t,l),sx:{ml:.5,p:.5,color:s.palette.grey[600],"&:hover":{color:s.palette.error.main,bgcolor:c(s.palette.error.main,.1)}},disabled:i||y,children:r.jsx(Y,{fontSize:"small"})})]},u))}):null:!m&&o?r.jsxs(N,{elevation:1,sx:{mt:2,p:2,borderRadius:W(),display:"flex",alignItems:"center",bgcolor:o.uploaded?c(s.palette.success.main,.05):c(s.palette.primary.main,.05),border:`1px solid ${o.uploaded?c(s.palette.success.main,.2):c(s.palette.primary.main,.1)}`},children:[(e=o.type)!=null&&e.startsWith("image/")?r.jsx(p,{component:"img",src:o.url,alt:"Preview",sx:{height:48,width:48,objectFit:"cover",borderRadius:"8px",mr:2}}):r.jsx(p,{sx:{height:48,width:48,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"8px",bgcolor:c(s.palette.primary.main,.1),mr:2},children:q(o.type)}),r.jsxs(p,{sx:{flex:1,minWidth:0},children:[r.jsx(x,{variant:"body1",sx:{fontWeight:500,mb:.5},noWrap:!0,children:o.name}),r.jsx(x,{variant:"caption",color:"text.secondary",children:cr(o.size)})]}),o.uploaded&&r.jsx(p,{sx:{mx:1},children:r.jsx(B,{title:"Uploaded successfully",children:r.jsx(V,{color:"success"})})}),r.jsx(nr,{variant:"outlined",color:"error",size:"small",onClick:t=>G(o,t),startIcon:r.jsx(Y,{}),sx:{borderRadius:2,ml:2},disabled:i||y,children:"Remove"})]}):null},K={...yr};return["onFileSelect"].forEach(e=>{e in K&&delete K[e]}),r.jsxs(p,{className:pr||"",children:[g&&r.jsx(p,{sx:{mb:1},children:r.jsxs(x,{variant:"subtitle2",sx:{fontWeight:500,color:"text.primary"},children:[g," ",gr&&r.jsx("span",{style:{color:s.palette.error.main},children:"*"})]})}),r.jsx(Dr,{children:r.jsx(ar.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0},transition:{duration:.2},children:r.jsxs(p,{sx:br(),onDragEnter:C&&!i?Fr:void 0,onDragLeave:C&&!i?Ir:void 0,onDragOver:C&&!i?Pr:void 0,onDrop:C&&!i?Rr:void 0,onClick:()=>{var e;return!i&&((e=E.current)==null?void 0:e.click())},children:[r.jsx("input",{ref:E,type:"file",name:n,accept:b,onChange:wr,multiple:m,style:{display:"none"},disabled:i,...K}),y?r.jsxs(p,{sx:{py:2,px:3,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx(Sr,{size:40,thickness:4,sx:{mb:2}}),xr&&r.jsxs(r.Fragment,{children:[r.jsx(Er,{variant:"determinate",value:X,sx:{width:"100%",height:8,borderRadius:4,mb:1}}),r.jsxs(x,{variant:"body2",color:"text.secondary",children:["Uploading... ",X,"%"]})]})]}):r.jsxs(p,{sx:{py:2,display:"flex",flexDirection:"column",alignItems:"center"},children:[r.jsx(ar.div,{whileHover:{y:-5},transition:{type:"spring",stiffness:300,damping:20},children:r.jsx(Wr,{sx:{fontSize:48,mb:2,color:I?s.palette.primary.main:s.palette.grey[400],opacity:i?.5:1}})}),r.jsx(x,{variant:"body1",sx:{mb:1,fontWeight:500},children:i?"Upload disabled":C?"Drag and drop files here or click to browse":"Click to browse files"}),r.jsxs(x,{variant:"caption",color:"text.secondary",children:["Supported formats: ",b," (Max: ",F,"MB)"]}),m&&!i&&r.jsx(x,{variant:"caption",color:"primary",sx:{mt:1,fontWeight:500},children:"You can upload multiple files"})]})]})})}),jr&&o&&!y&&r.jsxs(nr,{variant:"contained",color:"primary",startIcon:r.jsx(Br,{}),onClick:Cr,sx:{mt:2,borderRadius:2},fullWidth:!0,disabled:i||(m?o.length===0:!o)||y,children:["Upload ",m&&Array.isArray(o)?`${o.length} files`:"file"]}),fr&&kr(),vr&&r.jsxs(Lr,{severity:"success",sx:{mt:2,borderRadius:W()},onClose:()=>w(!1),children:["File",m?"s":""," uploaded successfully!"]}),(L||$)&&r.jsxs(p,{sx:{mt:1,display:"flex",alignItems:"center",color:s.palette.error.main},children:[r.jsx(Mr,{fontSize:"small",sx:{mr:.5,fontSize:"1rem"}}),r.jsx(x,{variant:"caption",children:L||$})]}),J&&!L&&!$&&r.jsx(x,{variant:"caption",sx:{mt:1,display:"block",color:s.palette.text.secondary},children:J})]})};export{se as F,Or as I};
