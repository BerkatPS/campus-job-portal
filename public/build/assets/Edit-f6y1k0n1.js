import{q as M,r as b,S as U,j as e,J as $}from"./app-BUVb_nAj.js";import{C as H}from"./Card-vSg9PuMO.js";import{D as C,I as k,B as h}from"./Button-DzGhUBn7.js";import{I as v}from"./Input-CZ4N0rVB.js";import{T as K}from"./TextArea-CO0sOTJt.js";import{F}from"./FormGroup-DX6tnawx.js";import{S as Q}from"./Select-CwiaD0cR.js";import{C as T}from"./Checkbox-DFrHN2i9.js";import{A as V}from"./Alert-W_CUoSxB.js";import{L as X}from"./Layout-DnkF-NCm.js";import{B as u,T as d,P as A}from"./Button-DFxjcZ8p.js";import{G as s}from"./Grid-CUDx21Kg.js";import{D as Y}from"./DragIndicator-DT8pKC7m.js";import{D as I}from"./Delete-DjrVMKuP.js";import{T as Z}from"./TextField-DdsD0Afg.js";import{A as B}from"./Add-Dwuu4lJj.js";import{S as ee}from"./Save-JdvVwzrr.js";import{A as te}from"./ArrowBack-Cgi6G0-j.js";import{F as re}from"./DynamicForm-Cje7f4Ql.js";import"./Card-D_rkxkaC.js";import"./MoreVert-PY4ZbxeC.js";import"./CardHeader-D023TrKm.js";import"./CardContent-DTmJK9ga.js";import"./InputLabel-DpN5m5Yk.js";import"./InputAdornment-CzgX0339.js";import"./VisibilityOff-BgFPuDcZ.js";import"./Visibility-clJeQAT9.js";import"./Info-CdM9Lqya.js";import"./Select-Bh9V9k3o.js";import"./Work-CLEsMByH.js";import"./Slide-DYtCGdXj.js";import"./FormControlLabel-DTCfN-Gd.js";import"./Checkbox-DZaxlRGh.js";import"./SwitchBase-BRw57M3-.js";import"./Alert-j9c9aQEr.js";import"./Close-CafbgWA1.js";import"./AlertTitle-CPDkbCwY.js";import"./AccessTime-DXhpyso9.js";import"./ArrowForward-Tz2ikYxH.js";import"./Close-B7UDIhaS.js";import"./Error-CSPDIC8t.js";import"./Warning-BLg7sOqp.js";import"./CheckCircle-Dd-oaFV0.js";import"./LinearProgress-3EBWbMR1.js";import"./Sidebar-DGzgELZX.js";import"./moment-C5S46NFB.js";import"./id-DNGKkZzB.js";import"./index-Dtg-WGcE.js";import"./Container-DEvTfuj0.js";import"./ChevronRight-FNylUib_.js";import"./Person-5k5xBlAT.js";import"./People-6TwBzk5z.js";import"./Event-DRCIx1GO.js";import"./Footer-DSErbOqA.js";const it=()=>{const{formSection:a,formFields:S}=M().props,[D,f]=b.useState(!1),[O,j]=b.useState(""),[w,g]=b.useState("error"),[n,c]=b.useState(S||[]),{data:m,setData:x,post:E,processing:_,errors:p}=U({_method:"PUT",name:a.name||"",description:a.description||"",is_enabled:a.is_enabled||!0,order_index:a.order_index||0}),N=t=>{if(t.preventDefault(),!z()){j("Please fill in all field names and provide options for select/radio/checkbox fields."),g("error"),f(!0);return}E(route("admin.form-builder.update",a.id),{data:{...m,fields:n},onSuccess:()=>{j("Form section updated successfully."),g("success"),f(!0)},onError:r=>{j("Please check the form for errors."),g("error"),f(!0),window.scrollTo(0,0)}})},P=()=>{c([...n,{name:"",field_type:"text",options:[],is_required:!1,order_index:n.length,form_section_id:a.id}])},W=t=>{const r=[...n];r.splice(t,1),r.forEach((o,i)=>{o.order_index=i}),c(r)},y=(t,r)=>{const o=[...n];o[t]=r,c(o)},q=t=>{const r=[...n],o=r[t];if(!o.options)o.options=[];else if(typeof o.options=="string")try{o.options=JSON.parse(o.options)}catch{o.options=[]}o.options.push(""),c(r)},J=(t,r,o)=>{const i=[...n],l=i[t];if(typeof l.options=="string")try{l.options=JSON.parse(l.options)}catch{l.options=[]}l.options[r]=o,c(i)},R=(t,r)=>{const o=[...n],i=o[t];if(typeof i.options=="string")try{i.options=JSON.parse(i.options)}catch{i.options=[]}i.options.splice(r,1),c(o)},z=()=>{if(n.length===0)return!1;for(const t of n){if(!t.name.trim())return!1;if(["select","radio","checkbox"].includes(t.field_type)){let r=t.options;if(typeof r=="string")try{r=JSON.parse(r)}catch{return!1}if(!r||!Array.isArray(r)||r.length===0)return!1;for(const o of r)if(!o.trim())return!1}}return!0},G=t=>{if(!t.options)return[];if(typeof t.options=="string")try{return JSON.parse(t.options)}catch{return[]}return t.options},L=[{value:"text",label:"Text Field"},{value:"textarea",label:"Text Area"},{value:"number",label:"Number"},{value:"email",label:"Email"},{value:"date",label:"Date"},{value:"select",label:"Dropdown Select"},{value:"radio",label:"Radio Buttons"},{value:"checkbox",label:"Checkboxes"},{value:"file",label:"File Upload"}];return e.jsx(e.Fragment,{children:e.jsxs(X,{children:[D&&e.jsx(V,{severity:w,onClose:()=>f(!1),sx:{mb:2},children:O}),e.jsx(H,{title:`Edit Form Section: ${a.name}`,icon:e.jsx(re,{}),action:e.jsx(h,{variant:"outlined",startIcon:e.jsx(te,{}),component:$,href:route("admin.form-builder.index"),children:"Back to Form Builder"}),children:e.jsxs(u,{component:"form",onSubmit:N,children:[e.jsxs(s,{container:!0,spacing:3,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(F,{label:"Section Information",marginBottom:"large",children:e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,children:e.jsx(v,{label:"Section Name",name:"name",value:m.name,onChange:t=>x("name",t.target.value),required:!0,error:p.name,helperText:p.name,fullWidth:!0,placeholder:"e.g., Personal Information, Education, Work Experience"})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(K,{label:"Description",name:"description",value:m.description||"",onChange:t=>x("description",t.target.value),error:p.description,helperText:p.description,rows:3,fullWidth:!0,placeholder:"Brief description of this form section"})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"Order Index",name:"order_index",type:"number",value:m.order_index,onChange:t=>x("order_index",t.target.value),error:p.order_index,helperText:p.order_index||"Determines the display order of sections",fullWidth:!0,InputProps:{inputProps:{min:0}}})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(T,{label:"Enable this section",name:"is_enabled",checked:m.is_enabled,onChange:t=>x("is_enabled",t.target.checked),helperText:"Disabled sections won't be shown in application forms"})})]})})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(F,{label:"Section Status",marginBottom:"large",children:[e.jsx(u,{sx:{mb:2},children:e.jsxs(d,{variant:"body2",color:"text.secondary",children:["This section has ",e.jsx("strong",{children:n.length})," field(s) and is currently ",e.jsx("strong",{children:m.is_enabled?"enabled":"disabled"}),"."]})}),e.jsx(d,{variant:"body2",fontWeight:500,children:"Notes:"}),e.jsx(d,{variant:"body2",color:"text.secondary",children:"- Changing field types will reset any options for that field"}),e.jsx(d,{variant:"body2",color:"text.secondary",children:"- Removing fields will delete any data collected by those fields"}),e.jsx(d,{variant:"body2",color:"text.secondary",children:"- The order of fields can be changed by dragging them up or down"})]})})]}),e.jsx(C,{sx:{my:3}}),e.jsxs(F,{label:"Form Fields",marginBottom:"large",children:[e.jsx(d,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Manage fields to collect information from applicants."}),n.map((t,r)=>e.jsxs(A,{sx:{p:2,mb:2,borderRadius:2,border:"1px solid",borderColor:"divider",position:"relative"},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(Y,{color:"action",sx:{mr:1}}),e.jsxs(d,{variant:"subtitle1",fontWeight:500,children:["Field #",r+1]}),e.jsx(u,{sx:{ml:"auto"},children:e.jsx(k,{color:"error",onClick:()=>W(r),size:"small",children:e.jsx(I,{fontSize:"small"})})})]}),e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"Field Name",value:t.name,onChange:o=>y(r,{...t,name:o.target.value}),required:!0,fullWidth:!0,placeholder:"e.g., Full Name, Email Address, Education Level"})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(Q,{label:"Field Type",value:t.field_type,onChange:o=>y(r,{...t,field_type:o.target.value}),options:L,required:!0,fullWidth:!0})}),e.jsx(s,{item:!0,xs:12,children:e.jsx(T,{label:"Required Field",checked:t.is_required,onChange:o=>y(r,{...t,is_required:o.target.checked}),helperText:"Applicants must fill this field to submit the application"})}),["select","radio","checkbox"].includes(t.field_type)&&e.jsx(s,{item:!0,xs:12,children:e.jsxs(A,{sx:{p:2,bgcolor:"background.default",borderRadius:1},children:[e.jsx(d,{variant:"subtitle2",gutterBottom:!0,children:"Options"}),G(t).map((o,i)=>e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:1},children:[e.jsx(Z,{size:"small",value:o,onChange:l=>J(r,i,l.target.value),placeholder:`Option ${i+1}`,fullWidth:!0,sx:{mr:1}}),e.jsx(k,{size:"small",color:"error",onClick:()=>R(r,i),children:e.jsx(I,{fontSize:"small"})})]},i)),e.jsx(h,{variant:"outlined",size:"small",startIcon:e.jsx(B,{}),onClick:()=>q(r),sx:{mt:1},children:"Add Option"})]})})]})]},r)),e.jsx(h,{variant:"outlined",startIcon:e.jsx(B,{}),onClick:P,sx:{mt:2},children:"Add Field"})]}),e.jsx(C,{sx:{my:3}}),e.jsxs(u,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(h,{type:"button",variant:"outlined",onClick:()=>{x({_method:"PUT",name:a.name||"",description:a.description||"",is_enabled:a.is_enabled||!0,order_index:a.order_index||0}),c(S||[])},disabled:_,children:"Reset"}),e.jsx(h,{type:"submit",variant:"contained",startIcon:e.jsx(ee,{}),loading:_,children:"Save Changes"})]})]})})]})})};export{it as default};
